{"version":3,"file":"main.c5ec1fdb2902397cfada.js","mappings":";;;;;AA8BA;AACA;;;;;;;;;;;ACnBA;ACHA;;;AAKA;;AAIA;;AAIA;;;;;;;;ACmNA;;;;;;;;;;;;;;;;;;ACtNA;;;;AAwEA;AAIA;;;AAGA;AAGA;AClGA;;AC0EA;AACA;;;;;;AAQA;;;AAKA;;;;AAMA;;;;;;AAOA;;;;;AC7FA;AACA;;ACQA;;;;;;ACPA;;;;AAIA;;;;;;;;;;;;;;;;;;;;;;;;AAwBA;;;;;;;;;;;;;AAeA;;AAIA;;;;AAMA;;;;;;AClDA;;AAGA;AAGA;;;;;;;ACLA;;;;ACCA;;;;ACNA;;;AAGA;;;ACGA;;;AAKA;;;;;;AAQA;;;;ACRA;;;ACTA;;;;AAMA;;AAWA;;;;AAMA;;;AAKA;;AAIA;;;AC9BA;;;;AC8CA;;;ACnDA;;;ACAA;;;;AAMA;;;ACIA;;AAUA;;;;AAAA;;;ACgIA;;;;;AAOA;;;;ACrIA;;;AA2HA;;;;AAMA;;;;AClJA;;;;ACJA;;;;;;AAMA;AAGA;;;;ACeA;;;;ACxBA;;AAEA;AAGA;;;;;ACyEA;;;;;AAKA;AAGA;;;;AAMA;;;;AAMA;AAGA;;;;AAMA;;;;;AAKA;AClHA;;;;;;;;ACWA;;;;AASA;;;;AAMA;;AAIA;;;;;AAOA;;;;;;;;;;;;ACtCA;AAGA;;ACAA;;;;;;ACGA;;;;AAMA;;;AAGA;AAGA;;;AAGA;AAGA;;;AAKA;;;ACtBA;;ACJA;;ACKA;;AAIA;;;;AAMA;;ACTA;;;;;ACLA;;AAIA;;;;;;AAQA;;;;AAKA;;AAIA;;;ACtBA;;ACQA;;;;;ACRA;ACLA;ACEA;;;;ACWA;;;;ACHA;;;;;ACGA;;;;AAIA;;AAIA;;;AAKA;;AAtBA;;AA4BA;;;;;AAOA;;AAIA;;AAEA;;AChBA;ACxBA;;;;;;AAMA;AACA;;;;;AAQA;;;;;AAKA;AACA;;AAIA;;AA9BA;AAAA;AAkCA;;AAIA;;;AAMA;AACA;AAIA;AAGA;;AAKA;AAEA;;AAEA;AACA;AAEA;;AAEA;;AAGA;;;;;;;;;;ACjEA;AAGA;;;;ACGA;;;;;;;ACFA;;;ACJA;;AAIA;ACgFA;AAMA;AAiBA;AC1GA;AACA;AACA;;ACJA;;;;;;;;;;AAYA;;AAWA;;;AChBA;;ACNA;;AAKA;;;;;;AAWA;;;;;;AAMA;;AAOA;;AC9BA;;ACGA;;;;AAIA;AACA;AAEA;AAGA;;;;;;;AAOA;;;AAGA;AC1BA;;AAIA;;;AAKA;;;AAIA;;ACXA;;ACEA;;AAIA;;;ACAA;;AAAA;;;;;;;;;;;;;;ACDA","sources":["webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/ArqueroDetailsList/renderers/CommandBarContainer.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/ArqueroDetailsList/renderers/EmptyCell.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/GroupHeader/GroupHeader.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/ArqueroDetailsList/ArqueroDetailsList.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/ArqueroTableHeader/TableName.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/ArqueroTableHeader/ArqueroTableHeader.constants.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/ArqueroTableHeader/ArqueroTableHeader.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/CommandBar.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/CommandBar.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/Guidance.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/controls/Expando.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbForm/VerbForm.styles.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbs/Filter.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/controls/CalendarPicker.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/controls/CalendarPicker.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbs/shared/FilterFunction.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbs/SetOperation.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbs/SetOperation.hooks.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/controls/SortInstruction.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbs/Orderby.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbs/shared/DataTypeField.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbs/Recode.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbs/Rename.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbs/Rollup.base.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbs/Sample.styles.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/StepComponent.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/StepSelector.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbForm/VerbDescription.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/verbDescriptions/AggregateDescription.tsx","webpack://@datashaper/webapp/./src/components/ControlBar.styles.ts","webpack://@datashaper/webapp/./src/components/Table.styles.ts","webpack://@datashaper/webapp/./src/components/Table.tsx","webpack://@datashaper/webapp/./src/components/Section.styles.ts","webpack://@datashaper/webapp/./src/components/Section.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/StepDescription.tsx","webpack://@datashaper/webapp/./src/components/StepOutput.styles.ts","webpack://@datashaper/webapp/./src/components/StepOutput.tsx","webpack://@datashaper/webapp/./src/pages/DebugPage.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/ManageWorkflow.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/StepCard.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/StepCard.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/DetailText.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/DetailText.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/StepList.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/StepList.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/TableTransformModal.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/TableTransformModal.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/PrepareDataFull.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/PreviewTable.styles.ts","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/PreviewTable.tsx","webpack://@datashaper/webapp/../../.yarn/__virtual__/@datashaper-react-virtual-81089ac0d8/1/javascript/react/src/components/TableListBar.styles.ts","webpack://@datashaper/webapp/./src/pages/PrepareDataPage.styles.ts","webpack://@datashaper/webapp/../../.yarn/cache/ajv-npm-8.11.0-83d029789c-5e0ff22680.zip/node_modules/ajv/dist/compile/validate/dataType.js","webpack://@datashaper/webapp/../../.yarn/cache/ajv-npm-8.11.0-83d029789c-5e0ff22680.zip/node_modules/ajv/dist/vocabularies/applicator/dependencies.js","webpack://@datashaper/webapp/./src/components/Footer.styles.ts","webpack://@datashaper/webapp/./src/components/Footer.tsx","webpack://@datashaper/webapp/./src/components/Header.styles.ts","webpack://@datashaper/webapp/./src/components/Header.tsx","webpack://@datashaper/webapp/./src/components/Layout.styles.ts","webpack://@datashaper/webapp/./src/components/NavPanel.styles.ts","webpack://@datashaper/webapp/./src/components/NavPanel.tsx","webpack://@datashaper/webapp/./src/components/SettingsPanel.styles.ts","webpack://@datashaper/webapp/./src/components/SettingsPanel.tsx","webpack://@datashaper/webapp/./src/App/App.tsx"],"sourcesContent":["/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\nimport type { IDetailsColumnProps, IRenderFunction } from '@fluentui/react'\nimport { memo } from 'react'\n\ninterface CommandBarContainerProps {\n\tprops: IDetailsColumnProps\n\trenderers: IRenderFunction<IDetailsColumnProps>[]\n}\n\nexport const CommandBarContainer: React.FC<CommandBarContainerProps> = memo(\n\tfunction CommandBarContainer({ props, renderers }) {\n\t\treturn (\n\t\t\t<Container className=\"header-command-bar\">\n\t\t\t\t{renderers.map((renderer, i) => (\n\t\t\t\t\t<Command key={i}>{renderer(props)}</Command>\n\t\t\t\t))}\n\t\t\t</Container>\n\t\t)\n\t},\n)\n\nconst Command = styled.div``\nconst Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n\tborder-top: 1px solid ${({ theme }) => theme.application().faint().hex()};\n\tborder-bottom: 1px solid ${({ theme }) => theme.application().faint().hex()};\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\n\nimport { useThematic } from '@thematic/react'\nimport { memo, useMemo } from 'react'\n\nimport type { FormattedCellProps } from './types.js'\n\n/**\n * Standard rendering of Empty values.\n */\nexport const EmptyCell: React.FC<FormattedCellProps> = memo(function EmptyCell({\n\ttextAlign,\n}) {\n\tconst theme = useThematic()\n\tconst style = useMemo(\n\t\t() => ({\n\t\t\twidth: '100%',\n\t\t\ttextAlign,\n\t\t\tcolor: theme.application().lowContrast().hex(),\n\t\t}),\n\t\t[theme, textAlign],\n\t)\n\treturn <div style={style}>&mdash;</div>\n})\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\n\nimport styled from '@essex/styled-components'\nimport { IconButton } from '@fluentui/react'\n\nexport const HeaderContainer = styled.div<{ groupLevel: number }>`\n\tpadding-left: ${({ groupLevel }) => `${groupLevel * 12}px`};\n\tdisplay: flex;\n\tgap: 8px;\n`\n\nexport const LevelButton = styled(IconButton as any)`\n\twidth: 5%;\n`\n\nexport const HeaderDetailsText = styled.span`\n\talign-self: center;\n`\n\nexport const Bold = styled.b``\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\n\nimport styled from '@essex/styled-components'\nimport type { IColumn, IDetailsListStyles } from '@fluentui/react'\nimport {\n\tConstrainMode,\n\tDetailsList,\n\tDetailsListLayoutMode,\n\tSelectionMode,\n} from '@fluentui/react'\nimport type { RowObject } from 'arquero/dist/types/table/table'\nimport { memo, useCallback, useEffect, useMemo, useState } from 'react'\n\nimport type {\n\tArqueroDetailsListProps,\n\tDetailsListFeatures,\n} from './ArqueroDetailsList.types.js'\nimport { debounceFn, groupBuilder } from './ArqueroDetailsList.utils.js'\nimport {\n\tuseColumns,\n\tuseDetailsHeaderRenderer,\n\tuseDetailsListStyles,\n\tuseGroupHeaderRenderer,\n\tuseSlicedTable,\n\tuseSortedGroups,\n\tuseSortedTable,\n\tuseSortHandling,\n\tuseStripedRowsRenderer,\n\tuseSubsetTable,\n\tuseTableMetadata,\n} from './hooks/index.js'\n\n/**\n * Renders an arquero table using a fluent DetailsList.\n */\nexport const ArqueroDetailsList: React.FC<ArqueroDetailsListProps> = memo(\n\tfunction ArqueroDetailsList({\n\t\ttable,\n\t\tfeatures = {},\n\t\tmetadata,\n\t\toffset = 0,\n\t\tlimit = Infinity,\n\t\tincludeAllColumns = true,\n\t\tvisibleColumns,\n\t\tisSortable = false,\n\t\tisStriped = false,\n\t\tisColumnClickable = false,\n\t\tshowColumnBorders = false,\n\t\tselectedColumn,\n\t\tonColumnClick,\n\t\tonCellDropdownSelect,\n\t\tonRenderGroupHeader,\n\t\tonChangeMetadata,\n\t\t// extract props we want to set data-centric defaults for\n\t\tselectionMode = SelectionMode.none,\n\t\tlayoutMode = DetailsListLayoutMode.fixedColumns,\n\t\tcolumns,\n\t\tonColumnHeaderClick,\n\t\tstyles,\n\t\tdefaultSortColumn,\n\t\tdefaultSortDirection,\n\t\tisHeadersFixed = false,\n\t\tcompact = false,\n\t\tisResizable = true,\n\t\t// passthrough the remainder as props\n\t\t...props\n\t}) {\n\t\tconst [version, setVersion] = useState(0)\n\t\tconst { sortColumn, sortDirection, handleColumnHeaderClick } =\n\t\t\tuseSortHandling(\n\t\t\t\tisSortable,\n\t\t\t\tonColumnHeaderClick,\n\t\t\t\tdefaultSortColumn,\n\t\t\t\tdefaultSortDirection,\n\t\t\t)\n\n\t\t// first subset the table using the visible columns\n\t\t// this will prevent any further operations on columns we aren't going to show\n\t\tconst subset = useSubsetTable(table, visibleColumns)\n\t\t// sort the table internally\n\t\t// note that this is different than the orderby of a pipeline step\n\t\t// this is a temporary sort only for the table display\n\t\tconst sorted = useSortedTable(subset, sortColumn, sortDirection)\n\t\t// slice any potential page\n\t\tconst sliced = useSlicedTable(sorted, offset, limit)\n\t\t// last, copy these items to actual JS objects for the DetailsList\n\t\tconst items = useMemo(() => sliced.objects(), [sliced])\n\n\t\t// if the table is grouped, groups the information in a way we can iterate\n\t\tconst groupedEntries = useMemo(\n\t\t\t() =>\n\t\t\t\ttable.isGrouped() ? sliced.objects({ grouped: 'entries' }) : undefined,\n\t\t\t[sliced, table],\n\t\t)\n\n\t\t// sorts first level group headers\n\t\tconst sortedGroups = useSortedGroups(\n\t\t\ttable,\n\t\t\tsortColumn,\n\t\t\tsortDirection,\n\t\t\tgroupedEntries,\n\t\t)\n\n\t\tconst computedMetadata = useTableMetadata(\n\t\t\ttable,\n\t\t\tmetadata,\n\t\t\tanyStatsFeatures(features),\n\t\t\tonChangeMetadata,\n\t\t)\n\n\t\tconst isDefaultHeaderClickable = useMemo((): any => {\n\t\t\treturn isSortable || isColumnClickable || !!onColumnHeaderClick\n\t\t}, [isSortable, isColumnClickable, onColumnHeaderClick])\n\n\t\tconst onColumnResize = useCallback(\n\t\t\t(column: IColumn | undefined, newWidth: number | undefined) => {\n\t\t\t\tconst set = () => setVersion(prev => prev + 1)\n\t\t\t\tif (column?.currentWidth !== newWidth) {\n\t\t\t\t\tdebounceFn(set)\n\t\t\t\t}\n\t\t\t},\n\t\t\t[setVersion],\n\t\t)\n\n\t\tconst displayColumns = useColumns(\n\t\t\ttable,\n\t\t\tcomputedMetadata,\n\t\t\tcolumns,\n\t\t\tvisibleColumns,\n\t\t\thandleColumnHeaderClick,\n\t\t\t{\n\t\t\t\tfeatures,\n\t\t\t\tsortColumn,\n\t\t\t\tsortDirection,\n\t\t\t\tselectedColumn,\n\t\t\t\tonColumnClick,\n\t\t\t\tonCellDropdownSelect,\n\t\t\t\tisDefaultHeaderClickable,\n\t\t\t\tincludeAllColumns,\n\t\t\t\tisColumnClickable,\n\t\t\t\tshowColumnBorders,\n\t\t\t\tcompact,\n\t\t\t\tisResizable,\n\t\t\t},\n\t\t)\n\n\t\tconst headerStyle = useDetailsListStyles(\n\t\t\tisHeadersFixed,\n\t\t\tfeatures,\n\t\t\tstyles as IDetailsListStyles,\n\t\t\t!!onColumnClick,\n\t\t\tcompact,\n\t\t)\n\n\t\tconst renderRow = useStripedRowsRenderer(isStriped, showColumnBorders)\n\t\tconst renderDetailsHeader = useDetailsHeaderRenderer()\n\t\tconst renderGroupHeader = useGroupHeaderRenderer(\n\t\t\ttable,\n\t\t\tcomputedMetadata,\n\t\t\tonRenderGroupHeader,\n\t\t\tfeatures.lazyLoadGroups,\n\t\t)\n\n\t\tconst groups = useMemo(() => {\n\t\t\tif (!sliced.isGrouped()) {\n\t\t\t\treturn undefined\n\t\t\t}\n\n\t\t\tconst existingGroups = sliced.groups()\n\t\t\tconst totalLevelCount = existingGroups.names.length\n\n\t\t\treturn sortedGroups?.map((row: RowObject) => {\n\t\t\t\tconst initialLevel = 0\n\t\t\t\treturn groupBuilder(\n\t\t\t\t\trow,\n\t\t\t\t\texistingGroups,\n\t\t\t\t\tinitialLevel,\n\t\t\t\t\ttotalLevelCount,\n\t\t\t\t\titems,\n\t\t\t\t\tsortDirection,\n\t\t\t\t\tfeatures.lazyLoadGroups,\n\t\t\t\t\tsortColumn,\n\t\t\t\t)\n\t\t\t})\n\t\t}, [sliced, sortedGroups, items, sortColumn, sortDirection, features])\n\t\t// as in FluentUI documentation, when updating item we can update the list items with a spread operator.\n\t\t// since when adding a new column we're changing the columns prop too, this approach doesn't work for that.\n\t\t// a workaround found in the issues suggest to use this version property to use as comparison to force re-render\n\t\tuseEffect(() => {\n\t\t\tsetVersion(prev => prev + 1)\n\t\t}, [columns, table, compact])\n\n\t\treturn (\n\t\t\t<DetailsWrapper data-is-scrollable=\"true\">\n\t\t\t\t<DetailsList\n\t\t\t\t\titems={[...items]}\n\t\t\t\t\tselectionMode={selectionMode}\n\t\t\t\t\tlayoutMode={layoutMode}\n\t\t\t\t\tgroups={groups}\n\t\t\t\t\tgetKey={(_: any, index?: number) => {\n\t\t\t\t\t\treturn (index as number).toString()\n\t\t\t\t\t}} //To be sure that every key is unique\n\t\t\t\t\tgroupProps={{\n\t\t\t\t\t\tonRenderHeader: renderGroupHeader,\n\t\t\t\t\t}}\n\t\t\t\t\tcolumns={displayColumns}\n\t\t\t\t\tconstrainMode={ConstrainMode.unconstrained}\n\t\t\t\t\tonRenderRow={renderRow}\n\t\t\t\t\tonRenderDetailsHeader={renderDetailsHeader}\n\t\t\t\t\tonColumnResize={onColumnResize}\n\t\t\t\t\tcompact={compact}\n\t\t\t\t\t{...props}\n\t\t\t\t\tlistProps={{\n\t\t\t\t\t\tversion,\n\t\t\t\t\t}}\n\t\t\t\t\tstyles={headerStyle}\n\t\t\t\t/>\n\t\t\t</DetailsWrapper>\n\t\t)\n\t},\n)\n\nconst DetailsWrapper = styled.div`\n\theight: inherit;\n\tposition: relative;\n\tmax-height: inherit;\n\toverflow-y: auto;\n\toverflow-x: auto;\n\n\tspan.ms-DetailsHeader-cellTitle {\n\t\tbackground-color: ${({ theme }) =>\n\t\t\ttheme.application?.().background().hex()};\n\t}\n\n\t.ms-List-cell {\n\t\tmin-height: unset;\n\t}\n\n\t.ms-CommandBar {\n\t\tpadding: unset;\n\t}\n\n\t.ms-OverflowSet {\n\t\tjustify-content: center;\n\t}\n`\n\nfunction anyStatsFeatures(features?: DetailsListFeatures) {\n\treturn Object.values(features || {}).some(v => v === true)\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\nimport { memo, useCallback, useEffect, useState } from 'react'\nimport { Else, If, Then } from 'react-if'\n\nimport { RenameCallout } from './RenameCallout.js'\n\nexport interface TableNameProps {\n\tonRenameTable?: (name: string) => void\n\tname?: string\n\tcolor?: string\n}\n\n/**\n * Renders the table name if passed, or the option to rename the name if the function\n * onRenameTable is passed to be called when clicking save or pressing enter on the callout\n */\nexport const TableName: React.FC<TableNameProps> = memo(function TableName({\n\tonRenameTable,\n\tname,\n\tcolor,\n}) {\n\tconst [isEditing, setIsEditing] = useState(false)\n\tconst [editedName, setEditedName] = useState(name || '')\n\n\tuseEffect(() => {\n\t\tsetEditedName(name as string)\n\t}, [name, setEditedName])\n\n\tconst onChange = useCallback(\n\t\t(_e: any, value?: string) => {\n\t\t\tsetEditedName(value as string)\n\t\t},\n\t\t[setEditedName],\n\t)\n\n\tconst onSend = useCallback(\n\t\t(newName?: string) => {\n\t\t\t// if the user enters an empty value, save the previous value\n\t\t\tconst incomingName = (!newName ? name : newName) as string\n\t\t\tonRenameTable && onRenameTable(incomingName)\n\t\t\tsetIsEditing(false)\n\t\t\tsetEditedName(incomingName)\n\t\t},\n\t\t[onRenameTable, setIsEditing, setEditedName, name],\n\t)\n\n\treturn (\n\t\t<Container>\n\t\t\t<If condition={!!onRenameTable}>\n\t\t\t\t<Then>\n\t\t\t\t\t<Container>\n\t\t\t\t\t\t<H3Editable\n\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\tid=\"editName\"\n\t\t\t\t\t\t\ttitle=\"Edit\"\n\t\t\t\t\t\t\tonClick={() => setIsEditing(true)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{name}\n\t\t\t\t\t\t</H3Editable>\n\t\t\t\t\t\t<If condition={isEditing}>\n\t\t\t\t\t\t\t<Then>\n\t\t\t\t\t\t\t\t<RenameCallout\n\t\t\t\t\t\t\t\t\tonSend={onSend}\n\t\t\t\t\t\t\t\t\teditedName={editedName}\n\t\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\t\tname={name}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Then>\n\t\t\t\t\t\t</If>\n\t\t\t\t\t</Container>\n\t\t\t\t</Then>\n\t\t\t\t<Else>\n\t\t\t\t\t<If condition={name}>\n\t\t\t\t\t\t<Then>\n\t\t\t\t\t\t\t<H3 color={color}>{name}</H3>\n\t\t\t\t\t\t</Then>\n\t\t\t\t\t</If>\n\t\t\t\t</Else>\n\t\t\t</If>\n\t\t</Container>\n\t)\n})\n\nconst H3 = styled.h3<{ color?: string }>`\n\tfont-weight: normal;\n\tfont-size: 0.8em;\n\tmargin-right: 8px;\n\tcolor: ${({ theme, color }) =>\n\t\tcolor || theme.application().background().hex()};\n`\n\nconst H3Editable = styled(H3)`\n\tcursor: pointer;\n\tborder-bottom: 1px dotted\n\t\t${({ theme }) => theme.application().background().hex()};\n`\n\nconst Container = styled.div``\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\n\nexport const HEIGHT = 36\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\n\nimport styled from '@essex/styled-components'\nimport { memo, useMemo } from 'react'\n\nimport { HEIGHT } from './ArqueroTableHeader.constants.js'\nimport {\n\tuseColorDefaults,\n\tuseColumnCounts,\n\tuseRowCounts,\n} from './hooks/index.js'\nimport type { ArqueroTableHeaderProps } from './index.js'\nimport { TableName } from './TableName.js'\n\nexport const ArqueroTableHeader: React.FC<ArqueroTableHeaderProps> = memo(\n\tfunction ArqueroTableHeader({\n\t\ttable,\n\t\tname,\n\t\tshowRowCount = true,\n\t\tshowColumnCount = true,\n\t\tcommandBar,\n\t\tfarCommandBar,\n\t\tvisibleColumns,\n\t\tonRenameTable,\n\t\tbgColor,\n\t\tcolor,\n\t}) {\n\t\tconst { background, foreground } = useColorDefaults(color, bgColor)\n\t\tconst groupCount = useMemo((): any => {\n\t\t\treturn table.isGrouped() ? table.groups().size : 0\n\t\t}, [table])\n\n\t\tconst columnCounts = useColumnCounts(table, visibleColumns)\n\t\tconst rowCounts = useRowCounts(table)\n\t\treturn (\n\t\t\t<Header bgColor={background} color={foreground}>\n\t\t\t\t<Left>{commandBar}</Left>\n\t\t\t\t<Middle>\n\t\t\t\t\t{name ? (\n\t\t\t\t\t\t<TableName\n\t\t\t\t\t\t\tonRenameTable={onRenameTable}\n\t\t\t\t\t\t\tname={name}\n\t\t\t\t\t\t\tcolor={foreground}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : null}\n\t\t\t\t\t{showRowCount === true ? (\n\t\t\t\t\t\t<H3>\n\t\t\t\t\t\t\t{`${rowCounts.visible} row${rowCounts.visible !== 1 ? 's' : ''}${\n\t\t\t\t\t\t\t\trowCounts.hidden > 0 ? ` (${rowCounts.hidden} filtered)` : ''\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t</H3>\n\t\t\t\t\t) : null}\n\t\t\t\t\t{showColumnCount === true ? (\n\t\t\t\t\t\t<H3>\n\t\t\t\t\t\t\t{`${columnCounts.visible} col${\n\t\t\t\t\t\t\t\tcolumnCounts.visible !== 1 ? 's' : ''\n\t\t\t\t\t\t\t}${\n\t\t\t\t\t\t\t\tcolumnCounts.hidden > 0\n\t\t\t\t\t\t\t\t\t? ` (${columnCounts.hidden} hidden)`\n\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t</H3>\n\t\t\t\t\t) : null}\n\t\t\t\t\t{groupCount ? <H3>{groupCount} groups</H3> : null}\n\t\t\t\t</Middle>\n\t\t\t\t<Right>{farCommandBar}</Right>\n\t\t\t</Header>\n\t\t)\n\t},\n)\n\nconst Header = styled.div<{ bgColor: string; color: string }>`\n\theight: ${HEIGHT}px;\n\twidth: 100%;\n\tbackground-color: ${({ bgColor }) => bgColor};\n\tcolor: ${({ color }) => color};\n\tposition: relative;\n\tbox-sizing: border-box;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n`\n\nconst H3 = styled.h3`\n\tfont-weight: normal;\n\tfont-size: 0.8em;\n`\n\nconst Left = styled.div`\n\tflex: 1;\n\tdisplay: flex;\n\tjustify-content: flex-start;\n`\n\nconst Middle = styled.div`\n\tflex: 2;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tgap: 8px;\n`\nconst Right = styled.div`\n\tflex: 1;\n\tdisplay: flex;\n\tjustify-content: flex-end;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const CommandBarWrapper = styled.div<{\n\theight?: string\n\tbgColor: string\n\tcolor: string\n}>`\n\tbackground-color: ${({ bgColor }) => bgColor};\n\tcolor: ${({ color }) => color || 'inherit'};\n\twidth: 100%;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { CommandBar as CB } from '@fluentui/react'\nimport { memo } from 'react'\n\nimport {\n\tuseColorDefaults,\n\tuseCommands,\n\tuseCommandStyles,\n\tuseHandleOnDataGrown,\n\tuseHandleOnDataReduce,\n\tuseOverflowButtonProps,\n} from './CommandBar.hooks.js'\nimport { CommandBarWrapper } from './CommandBar.styles.js'\nimport type { CommandBarProps } from './CommandBar.types.js'\n\n/**\n * Extends the fluent command bar to override styles and collapsing for our inverted header\n */\nexport const CommandBar: React.FC<CommandBarProps> = memo(function CommandBar({\n\titems,\n\theight,\n\tbgColor,\n\tcolor,\n\tstyles,\n\t...props\n}) {\n\tconst { foreground, background } = useColorDefaults(color, bgColor)\n\tconst overflowButtonProps = useOverflowButtonProps(background, foreground)\n\tconst handleOnDataReduce = useHandleOnDataReduce(foreground)\n\tconst handleOnDataGrown = useHandleOnDataGrown(foreground)\n\tconst commandStyles = useCommandStyles(styles)\n\tconst fixedItems = useCommands(items, background, foreground)\n\treturn (\n\t\t<CommandBarWrapper bgColor={background} color={foreground}>\n\t\t\t<CB\n\t\t\t\titems={fixedItems}\n\t\t\t\tstyles={commandStyles}\n\t\t\t\toverflowButtonProps={overflowButtonProps}\n\t\t\t\tonDataReduced={handleOnDataReduce}\n\t\t\t\tonDataGrown={handleOnDataGrown}\n\t\t\t\t{...props}\n\t\t\t/>\n\t\t</CommandBarWrapper>\n\t)\n})\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\nimport { IconButton } from '@fluentui/react'\n\nexport const Container = styled.div`\n\tposition: relative;\n\n\th1 {\n\t\tmargin-top: 0;\n\t\ttext-transform: uppercase;\n\t\tcolor: ${({ theme }) => theme.application().lowMidContrast().hex()};\n\t}\n\n\th2 {\n\t\tcolor: ${({ theme }) => theme.application().midContrast().hex()};\n\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 1rem;\n\n\t\t&.active + .details {\n\t\t\topacity: 1;\n\t\t\theight: auto;\n\t\t\ttransform: translateX(0);\n\t\t\toverflow-x: auto;\n\t\t}\n\t}\n\n\ttable {\n\t\tborder-collapse: collapse;\n\n\t\tth {\n\t\t\tfont-weight: bold;\n\t\t}\n\n\t\ttd,\n\t\tth {\n\t\t\tborder: 1px solid\n\t\t\t\t${({ theme }) => theme.application().lowContrast().hex()};\n\t\t\tpadding: 5px;\n\t\t\ttext-align: center;\n\t\t}\n\t}\n\n\t.details {\n\t\topacity: 0;\n\t\theight: 0;\n\t\ttransition: transform 0.5s ease-in-out;\n\t\ttransform: translateX(100%);\n\t\toverflow-x: hidden;\n\t}\n`\n\nexport const Icon = styled(IconButton as any)`\n\tfont-size: 2.5rem;\n`\n\nexport const ButtonWrapper = styled.div`\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n`\n\nexport const icons = {\n\tback: { iconName: 'Back' },\n\thome: { iconName: 'Home' },\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const LeftAlignedRow = styled.div`\n\twidth: 100%;\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: flex-start;\n\talign-items: flex-end;\n`\n\n/**\n * For explanatory text below an input,\n */\nexport const InputExplainer = styled.div`\n\tfont-size: 0.85em;\n\tcolor: ${({ theme }) => theme.application().midHighContrast().hex()};\n`\n\nexport const dropdownStyles = {\n\troot: {\n\t\twidth: 220,\n\t},\n}\n\nexport const checkboxStyles = {\n\troot: {\n\t\twidth: 220,\n\t\tpaddingTop: '10px',\n\t},\n}\n\n/**\n * For side-by-side dropdowns with a 12px gap\n */\nexport const narrowDropdownStyles = {\n\troot: {\n\t\twidth: 135,\n\t},\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const Container = styled.div``\n\nexport const Toggle = styled.div`\n\theight: 20px;\n\tfont-size: 0.95em;\n\twidth: 220px;\n\tdisplay: flex;\n\tgap: 4px;\n\talign-items: center;\n`\n\nexport const expandoIconStyles = {\n\troot: {\n\t\tfontSize: 8,\n\t\twidth: 10,\n\t\theight: 16,\n\t},\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const dropdownStyles = {\n\troot: {\n\t\twidth: 220,\n\t},\n}\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 8px;\n`\n\nexport const InputsBlock = styled.div``\n\nexport const Row = styled.div``\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: flex-start;\n`\n\nexport const Vertical = styled.div<{ index: number }>`\n\tdisplay: flex;\n\tflex-direction: column;\n\tmargin-top: ${({ index }) => (index > 0 ? 6 : 0)}px;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\nimport { FontIcon, Label, mergeStyles } from '@fluentui/react'\n\nexport const iconClass = mergeStyles({\n\tfontSize: 20,\n\theight: 25,\n\twidth: 25,\n\tmargin: '0 25px',\n})\n\nexport const Container = styled.div`\n\tdisplay: inline;\n`\n\nexport const CalendarContainer = styled.div`\n\tdisplay: flex;\n\tjustify-content: space-between;\n`\n\nexport const CalendarButton = styled(FontIcon)`\n\tdisplay: inline;\n\tfloat: left;\n\tmargin-top: 5px;\n\tmargin-left: 10px;\n\tmargin-right: 0px;\n`\n\nexport const CalendarLabel = styled(Label)`\n\tdisplay: inline;\n\tfloat: left;\n\tmargin-left: 10px;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport {\n\tCalendar,\n\tCallout,\n\tdefaultCalendarStrings,\n\tDirectionalHint,\n\tFocusTrapZone,\n} from '@fluentui/react'\nimport { useBoolean } from '@fluentui/react-hooks'\nimport { memo, useCallback, useRef, useState } from 'react'\n\nimport {\n\tCalendarButton,\n\tCalendarContainer,\n\tCalendarLabel,\n\tContainer,\n\ticonClass,\n} from './CalendarPicker.styles.js'\nimport type { CalendarPickerProps } from './CalendarPicker.types.js'\n\nexport const CalendarPicker: React.FC<CalendarPickerProps> = memo(\n\tfunction CalendarPicker({ onSelectDate, value, disabled, cleanLabel }) {\n\t\tconst [selectedDate, setSelectedDate] = useState<Date>(value ?? new Date())\n\t\tconst [\n\t\t\tshowCalendar,\n\t\t\t{ toggle: toggleShowCalendar, setFalse: hideCalendar },\n\t\t] = useBoolean(false)\n\t\tconst buttonContainerRef = useRef<HTMLDivElement>(null)\n\n\t\tconst onSelectDateChange = useCallback(\n\t\t\t(date: Date): void => {\n\t\t\t\tsetSelectedDate(date)\n\t\t\t\thideCalendar()\n\t\t\t},\n\t\t\t[hideCalendar],\n\t\t)\n\n\t\treturn (\n\t\t\t<Container>\n\t\t\t\t<CalendarContainer ref={buttonContainerRef}>\n\t\t\t\t\t<CalendarButton\n\t\t\t\t\t\taria-label=\"Compass\"\n\t\t\t\t\t\ticonName=\"Calendar\"\n\t\t\t\t\t\tclassName={iconClass}\n\t\t\t\t\t\tonClick={!disabled ? toggleShowCalendar : undefined}\n\t\t\t\t\t\tstyle={\n\t\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t\t\t? { cursor: 'default', color: 'rgb(118, 118, 118)' }\n\t\t\t\t\t\t\t\t: { cursor: 'pointer', color: 'rgb(241, 241, 241)' }\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t\t{selectedDate !== undefined && !cleanLabel ? (\n\t\t\t\t\t\t<CalendarLabel>\n\t\t\t\t\t\t\t{!cleanLabel ? selectedDate?.toLocaleDateString() : ''}\n\t\t\t\t\t\t</CalendarLabel>\n\t\t\t\t\t) : null}\n\t\t\t\t</CalendarContainer>\n\t\t\t\t{showCalendar && (\n\t\t\t\t\t<Callout\n\t\t\t\t\t\tisBeakVisible={false}\n\t\t\t\t\t\tgapSpace={0}\n\t\t\t\t\t\tdoNotLayer={false}\n\t\t\t\t\t\ttarget={buttonContainerRef}\n\t\t\t\t\t\tdirectionalHint={DirectionalHint.bottomLeftEdge}\n\t\t\t\t\t\tonDismiss={hideCalendar}\n\t\t\t\t\t\tsetInitialFocus\n\t\t\t\t\t>\n\t\t\t\t\t\t<FocusTrapZone isClickableOutsideFocusTrap>\n\t\t\t\t\t\t\t<Calendar\n\t\t\t\t\t\t\t\tonDismiss={hideCalendar}\n\t\t\t\t\t\t\t\tshowMonthPickerAsOverlay\n\t\t\t\t\t\t\t\thighlightSelectedMonth\n\t\t\t\t\t\t\t\tshowGoToToday={false}\n\t\t\t\t\t\t\t\tonSelectDate={(date: Date) => {\n\t\t\t\t\t\t\t\t\tonSelectDate(date)\n\t\t\t\t\t\t\t\t\tonSelectDateChange(date)\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tvalue={selectedDate}\n\t\t\t\t\t\t\t\t// Calendar uses English strings by default. For localized apps, you must override this prop.\n\t\t\t\t\t\t\t\tstrings={defaultCalendarStrings}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FocusTrapZone>\n\t\t\t\t\t</Callout>\n\t\t\t\t)}\n\t\t\t</Container>\n\t\t)\n\t},\n)\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\nimport { Label, TextField, Toggle } from '@fluentui/react'\n\nimport { narrowDropdownStyles } from '../../styles.js'\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n`\n\nexport const SideBySide = styled.div`\n\tdisplay: flex;\n\tjustify-content: flex-start;\n\talign-items: flex-end;\n`\n\nexport const leftStyles = {\n\troot: {\n\t\t...narrowDropdownStyles.root,\n\t\tmarginRight: 12,\n\t},\n}\n\nexport const TextValue = styled(TextField)`\n\tdisplay: inline;\n`\n\nexport const OrLabel = styled(Label)`\n\tdisplay: inline;\n\tpadding-left: 10px;\n\tpadding-right: 10px;\n`\n\nexport const FilterContainer = styled.div`\n\tdisplay: flex;\n\tjustify-content: space-between;\n`\n\nexport const BooleanToggle = styled(Toggle)`\n\tmargin-top: 5px;\n`\n\nexport const spinStyles = {\n\troot: {\n\t\twidth: 120,\n\t},\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const icons = {\n\tadd: { iconName: 'Add' },\n\tdelete: { iconName: 'Delete' },\n}\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n`\n\nexport const Tables = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 5px;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport type { GraphManager, Step } from '@datashaper/core'\nimport { IconButton } from '@fluentui/react'\nimport { useMemo } from 'react'\n\nimport { TableDropdown } from '../controls/index.js'\nimport { useSimpleDropdownOptions, useTableNames } from '../hooks/index.js'\nimport { LeftAlignedRow } from '../styles.js'\nimport { icons } from './SetOperation.styles.js'\n\nexport function useOthers(\n\tstep: Step,\n\tonChange?: (step: Step) => void,\n\tstore?: GraphManager,\n): (JSX.Element | null)[] {\n\tconst tableNames = useTableNames(store)\n\tconst tableOptions = useSimpleDropdownOptions(tableNames)\n\treturn useMemo<(JSX.Element | null)[]>(() => {\n\t\treturn (step.input.others || EMPTY).map((input, index) => {\n\t\t\tconst other = input.node\n\n\t\t\t// on delete, remove the input\n\t\t\tconst handleDeleteClick = () => {\n\t\t\t\tonChange?.({\n\t\t\t\t\t...step,\n\t\t\t\t\tinput: {\n\t\t\t\t\t\t...step.input,\n\t\t\t\t\t\tothers: (step.input.others || EMPTY).filter(o => o !== input),\n\t\t\t\t\t} as Step['input'],\n\t\t\t\t})\n\t\t\t}\n\t\t\tif (!store) {\n\t\t\t\treturn null\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<LeftAlignedRow key={`set-op-${other}-${index}`}>\n\t\t\t\t\t<TableDropdown\n\t\t\t\t\t\tlabel={''}\n\t\t\t\t\t\toptions={tableOptions}\n\t\t\t\t\t\tselectedKey={other}\n\t\t\t\t\t\tonChange={(_evt, option) => {\n\t\t\t\t\t\t\tconst update = { ...step }\n\t\t\t\t\t\t\tif (option) {\n\t\t\t\t\t\t\t\tinput.node = `${option.key}`\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tonChange?.(update)\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\ttitle={'Remove this table'}\n\t\t\t\t\t\ticonProps={icons.delete}\n\t\t\t\t\t\tonClick={handleDeleteClick}\n\t\t\t\t\t/>\n\t\t\t\t</LeftAlignedRow>\n\t\t\t)\n\t\t})\n\t}, [step, store, tableOptions, onChange])\n}\n\nconst EMPTY: any[] = []\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\tjustify-content: flex-start;\n`\n\nexport const icons = {\n\tdelete: { iconName: 'Delete' },\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n`\n\nexport const Sorts = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 5px;\n`\n\nexport const icons = {\n\tadd: { iconName: 'Add' },\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\nimport { Label, TextField } from '@fluentui/react'\n\nimport { narrowDropdownStyles } from '../../styles.js'\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n`\n\nexport const leftStyles = {\n\troot: {\n\t\t...narrowDropdownStyles.root,\n\t\tmarginRight: 12,\n\t},\n}\n\nexport const TextValue = styled(TextField)`\n\tdisplay: inline;\n`\n\nexport const OrLabel = styled(Label)`\n\tdisplay: inline;\n\tpadding-left: 10px;\n\tpadding-right: 10px;\n`\n\nexport const spinStyles = {\n\troot: {\n\t\twidth: 120,\n\t},\n}\n\nexport const dropdownStyles = {\n\troot: {\n\t\twidth: 150,\n\t},\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport type { Value } from '@datashaper/arquero'\nimport { coerce , DataType} from '@datashaper/arquero'\nimport type { RecodeArgs, Step } from '@datashaper/core'\nimport styled from '@essex/styled-components'\nimport { ActionButton, Icon, IconButton } from '@fluentui/react'\nimport type ColumnTable from 'arquero/dist/types/table/column-table'\nimport { memo, useMemo } from 'react'\n\nimport { useColumnType, useStepDataTable } from '../hooks/index.js'\nimport type { StepComponentProps } from '../types.js'\nimport {\n\tuseColumnValues,\n\tuseDisabled,\n\tuseHandleAddButtonClick,\n\tuseHandleKeyChange,\n\tuseHandleValueChange,\n\tuseRecodeDelete,\n} from './Recode.hooks.js'\nimport { DataTypeField } from './shared/DataTypeField.js'\n\n/**\n * Provides inputs for a RecodeStep.\n */\nexport const Recode: React.FC<StepComponentProps<RecodeArgs>> = memo(\n\tfunction Recode({ step, graph, input, table, onChange }) {\n\t\tconst dataTable = useStepDataTable(step, graph, input, table)\n\t\tconst dataType = useColumnType(dataTable, step.args.column)\n\t\tconst initialValues = useColumnValues(step, dataTable)\n\t\tconst values =\n\t\t\tdataType === DataType.Date\n\t\t\t\t? initialValues.map(e => e.toISOString())\n\t\t\t\t: initialValues\n\t\tconst handleRecodeKeyChange = useHandleKeyChange(step, onChange)\n\t\tconst handleRecodeValueChange = useHandleValueChange(step, onChange)\n\t\tconst handleRecodeDelete = useRecodeDelete(step, onChange)\n\t\tconst handleButtonClick = useHandleAddButtonClick(step, values, onChange)\n\n\t\tconst columnPairs = useRecodePairs(\n\t\t\tdataTable,\n\t\t\tstep,\n\t\t\tdataType,\n\t\t\thandleRecodeKeyChange,\n\t\t\thandleRecodeValueChange,\n\t\t\thandleRecodeDelete,\n\t\t)\n\n\t\tconst disabled = useDisabled(step, values)\n\n\t\treturn (\n\t\t\t<Container>\n\t\t\t\t<ColumnPairs>{columnPairs}</ColumnPairs>\n\t\t\t\t<ActionButton\n\t\t\t\t\tonClick={handleButtonClick}\n\t\t\t\t\ticonProps={{ iconName: 'Add' }}\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t>\n\t\t\t\t\tAdd mapping\n\t\t\t\t</ActionButton>\n\t\t\t</Container>\n\t\t)\n\t},\n)\n\nfunction useRecodePairs(\n\ttable: ColumnTable | undefined,\n\tstep: Step<RecodeArgs>,\n\tdataType: DataType,\n\tonKeyChange: (oldKey: Value, newKey: Value) => void,\n\tonValueChange: (key: Value, newValue: Value) => void,\n\tonDelete: (value: Value) => void,\n) {\n\treturn useMemo(() => {\n\t\tconst { map } = step.args\n\t\treturn Object.entries(map || {}).map((valuePair, index) => {\n\t\t\tconst [o] = valuePair\n\t\t\tconst oldvalue = coerce(o, dataType)\n\t\t\treturn (\n\t\t\t\t<ColumnPair\n\t\t\t\t\tvaluePair={valuePair}\n\t\t\t\t\tdataType={dataType}\n\t\t\t\t\tkey={`column-Recode-${oldvalue}-${index}`}\n\t\t\t\t\tonKeyChange={onKeyChange}\n\t\t\t\t\tonValueChange={onValueChange}\n\t\t\t\t\tonDelete={onDelete}\n\t\t\t\t/>\n\t\t\t)\n\t\t})\n\t}, [table, step, dataType, onKeyChange, onValueChange, onDelete])\n}\n\nconst ColumnPair: React.FC<{\n\tvaluePair: [string, any]\n\tdataType: DataType\n\tonKeyChange: (oldKey: Value, newKey: Value) => void\n\tonValueChange: (key: Value, newValue: Value) => void\n\tonDelete: (value: Value) => void\n}> = memo(function ColumnPair({\n\tvaluePair,\n\tdataType,\n\tonKeyChange,\n\tonValueChange,\n\tonDelete,\n}) {\n\t// the old value will always come off the map as a string key\n\t// coerce it to the column type for proper comparison\n\tconst [o, q] = valuePair\n\tlet oldvalue = coerce(o, dataType)\n\tconst newvalue = coerce(q, dataType)\n\n\tif (dataType === DataType.Boolean) {\n\t\to === 'false' ? (oldvalue = false) : (oldvalue = true)\n\t}\n\n\tconst handleDeleteClick = () => onDelete(oldvalue)\n\n\treturn (\n\t\t<ColumnPairContainer>\n\t\t\t<DataTypeField\n\t\t\t\tplaceholder={'Current value'}\n\t\t\t\tdataType={dataType}\n\t\t\t\tvalue={oldvalue}\n\t\t\t\tonKeyChange={onKeyChange}\n\t\t\t\tonValueChange={onKeyChange}\n\t\t\t\tisKey={true}\n\t\t\t\tkeyValue={oldvalue}\n\t\t\t/>\n\n\t\t\t<Icon\n\t\t\t\ticonName={'Forward'}\n\t\t\t\tstyles={{ root: { marginLeft: 4, marginRight: 4 } }}\n\t\t\t/>\n\n\t\t\t<DataTypeField\n\t\t\t\tplaceholder={'New Value'}\n\t\t\t\tdataType={dataType}\n\t\t\t\tkeyValue={oldvalue}\n\t\t\t\tvalue={newvalue}\n\t\t\t\tonKeyChange={onValueChange}\n\t\t\t\tonValueChange={onValueChange}\n\t\t\t\tisKey={false}\n\t\t\t/>\n\n\t\t\t<IconButton\n\t\t\t\ttitle={'Remove this Recode'}\n\t\t\t\ticonProps={{ iconName: 'Delete' }}\n\t\t\t\tonClick={handleDeleteClick}\n\t\t\t/>\n\t\t</ColumnPairContainer>\n\t)\n})\n\nconst Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n`\nconst ColumnPairs = styled.div`\n\tmargin-top: 8px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 5px;\n`\n\nconst ColumnPairContainer = styled.div`\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport type { RenameArgs, Step } from '@datashaper/core'\nimport styled from '@essex/styled-components'\nimport type { IDropdownOption } from '@fluentui/react'\nimport {\n\tActionButton,\n\tIcon,\n\tIconButton,\n\tLabel,\n\tTextField,\n} from '@fluentui/react'\nimport type ColumnTable from 'arquero/dist/types/table/column-table'\nimport { memo, useMemo } from 'react'\n\nimport { TableColumnDropdown } from '../controls/index.js'\nimport {\n\tuseColumnRecordDelete,\n\tuseSimpleDropdownOptions,\n\tuseStepDataTable,\n\tuseTableColumnNames,\n} from '../hooks/index.js'\nimport type { StepComponentProps } from '../types.js'\nimport {\n\tuseDisabled,\n\tuseHandleAddButtonClick,\n\tuseHandleColumnChange,\n} from './Rename.hooks.js'\n\n/**\n * Provides inputs for a RenameStep.\n */\nexport const Rename: React.FC<StepComponentProps<RenameArgs>> = memo(\n\tfunction Rename({ step, graph, input, table, onChange }) {\n\t\tconst dataTable = useStepDataTable(step, graph, input, table)\n\t\tconst handleColumnChange = useHandleColumnChange(step, onChange)\n\t\tconst handleColumnDelete = useColumnRecordDelete(step, onChange)\n\t\tconst handleButtonClick = useHandleAddButtonClick(step, dataTable, onChange)\n\t\tconst columnPairs = useColumnPairs(\n\t\t\tdataTable,\n\t\t\tstep,\n\t\t\thandleColumnChange,\n\t\t\thandleColumnDelete,\n\t\t)\n\t\tconst disabled = useDisabled(step, dataTable)\n\n\t\treturn (\n\t\t\t<Container>\n\t\t\t\t<Label required>Column renames</Label>\n\t\t\t\t<ColumnPairs>{columnPairs}</ColumnPairs>\n\t\t\t\t<ActionButton\n\t\t\t\t\tonClick={handleButtonClick}\n\t\t\t\t\ticonProps={{ iconName: 'Add' }}\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t>\n\t\t\t\t\tAdd rename\n\t\t\t\t</ActionButton>\n\t\t\t</Container>\n\t\t)\n\t},\n)\n\nfunction useColumnPairs(\n\ttable: ColumnTable | undefined,\n\tstep: Step<RenameArgs>,\n\tonChange: (previous: string, oldName: string, newName: string) => void,\n\tonDelete: (name: string) => void,\n) {\n\treturn useMemo(() => {\n\t\tconst { columns } = step.args\n\t\treturn Object.entries(columns || {}).map((column, index) => {\n\t\t\tconst [oldname] = column\n\t\t\treturn (\n\t\t\t\t<ColumnPair\n\t\t\t\t\tkey={`column-rename-${oldname}-${index}`}\n\t\t\t\t\ttable={table}\n\t\t\t\t\tcolumn={column}\n\t\t\t\t\tstep={step}\n\t\t\t\t\tonChange={onChange}\n\t\t\t\t\tonDelete={onDelete}\n\t\t\t\t/>\n\t\t\t)\n\t\t})\n\t}, [table, step, onChange, onDelete])\n}\n\nconst ColumnPair: React.FC<{\n\ttable: ColumnTable | undefined\n\tcolumn: [string, string]\n\tstep: Step<RenameArgs>\n\tonChange: (previous: string, oldName: string, newName: string) => void\n\tonDelete: (name: string) => void\n}> = memo(function ColumnPair({ table, column, step, onChange, onDelete }) {\n\tconst [oldname, newname] = column\n\tconst columnFilter = (name: string) => {\n\t\tif (name === oldname) {\n\t\t\treturn true\n\t\t}\n\t\tif (step.args.columns && step.args.columns[name]) {\n\t\t\treturn false\n\t\t}\n\t\treturn true\n\t}\n\tconst handleColumnChange = (\n\t\t_e: React.FormEvent<HTMLDivElement>,\n\t\topt?: IDropdownOption<any> | undefined,\n\t) => onChange(oldname, (opt?.key as string) || oldname, newname)\n\tconst handleTextChange = (\n\t\t_e: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>,\n\t\tnewValue?: string,\n\t) => {\n\t\tonChange(oldname, oldname, newValue ?? '')\n\t}\n\tconst handleDeleteClick = () => onDelete(oldname)\n\tconst columns = useTableColumnNames(table, columnFilter)\n\tconst options = useSimpleDropdownOptions(columns)\n\n\treturn (\n\t\t<ColumnPairContainer>\n\t\t\t<TableColumnDropdown\n\t\t\t\toptions={options}\n\t\t\t\tlabel={undefined}\n\t\t\t\tselectedKey={oldname}\n\t\t\t\tonChange={handleColumnChange}\n\t\t\t\tstyles={{\n\t\t\t\t\troot: {\n\t\t\t\t\t\twidth: 130,\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<Icon\n\t\t\t\ticonName={'Forward'}\n\t\t\t\tstyles={{ root: { marginLeft: 4, marginRight: 4 } }}\n\t\t\t/>\n\t\t\t<TextField\n\t\t\t\tplaceholder={'New name'}\n\t\t\t\tvalue={newname}\n\t\t\t\tonChange={handleTextChange}\n\t\t\t\tstyles={{ root: { width: 130 } }}\n\t\t\t/>\n\t\t\t<IconButton\n\t\t\t\ttitle={'Remove this rename'}\n\t\t\t\ticonProps={{ iconName: 'Delete' }}\n\t\t\t\tonClick={handleDeleteClick}\n\t\t\t/>\n\t\t</ColumnPairContainer>\n\t)\n})\n\nconst Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n`\n\nconst ColumnPairs = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 5px;\n`\n\nconst ColumnPairContainer = styled.div`\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport type { RollupArgs } from '@datashaper/core'\nimport { FieldAggregateOperation } from '@datashaper/core'\nimport { memo, useMemo } from 'react'\n\nimport type { StepComponentProps } from '../types.js'\nimport type { FormInput } from '../verbForm/VerbForm.js'\nimport { VerbForm } from '../verbForm/VerbForm.js'\nimport { enumDropdown } from '../verbForm/VerbFormFactories.js'\n\n/**\n * Just the column/op inputs for an rollup.\n * Input table is expected to be edited elsewhere and configured as the step input.\n */\nexport const RollupBase: React.FC<StepComponentProps<RollupArgs>> = memo(\n\tfunction RollupBase({ step, onChange }) {\n\t\tconst inputs = useMemo<FormInput<RollupArgs>[]>(\n\t\t\t() => [\n\t\t\t\tenumDropdown(\n\t\t\t\t\t'Function',\n\t\t\t\t\tFieldAggregateOperation,\n\t\t\t\t\tstep.args.operation,\n\t\t\t\t\t(s, val) => (s.args.operation = val as FieldAggregateOperation),\n\t\t\t\t\t{ required: true },\n\t\t\t\t),\n\t\t\t],\n\t\t\t[step],\n\t\t)\n\n\t\treturn <VerbForm inputs={inputs} step={step} onChange={onChange} />\n\t},\n)\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n`\n\nexport const Or = styled.div`\n\tmargin-left: 8px;\n\tmargin-right: 8px;\n\theight: 100%;\n\tdisplay: flex;\n\talign-items: center;\n\tcolor: ${({ theme }) => theme.application().midContrast().hex()};\n`\n\nexport const spinStyles = {\n\troot: {\n\t\twidth: 120,\n\t},\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport type { InputColumnArgs, OutputColumnArgs } from '@datashaper/core'\nimport {\n\tisInputColumnStep,\n\tisInputTableStep,\n\tisOutputColumnStep,\n} from '@datashaper/core'\nimport { NodeInput } from '@datashaper/dataflow'\nimport { TextField } from '@fluentui/react'\nimport { memo } from 'react'\n\nimport { TableColumnDropdown } from '../controls/TableColumnDropdown.js'\nimport { TableDropdown } from '../controls/TableDropdown.js'\nimport { useDataTable } from '../hooks/useDataTable.js'\nimport { useSimpleDropdownOptions } from '../hooks/useSimpleDropdownOptions.js'\nimport { useTableColumnNames } from '../hooks/useTableColumnNames.js'\nimport { useTableNames } from '../hooks/useTableNames.js'\nimport { dropdownStyles } from '../styles.js'\nimport {\n\tuseColumnFilter,\n\tuseDefaultOutputNameInitially,\n\tuseInputColumnChanged,\n\tuseInputTableChanged,\n\tuseOutputColumnChanged,\n\tuseOutputTableChanged,\n\tuseStepArgsComponent,\n\tuseStepChangeHandler,\n} from './StepComponent.hooks.js'\nimport { Container } from './StepComponent.styles.js'\nimport type { StepComponentProps } from './StepComponent.types.js'\n\n/**\n * Let's us render the Steps in a loop while memoing all the functions\n */\nexport const StepComponent: React.FC<StepComponentProps> = memo(\n\tfunction StepComponent({\n\t\tstep: s,\n\t\toutput,\n\t\tgraph: g,\n\t\tindex,\n\t\tinputTableLabel,\n\t\tinputColumnLabel,\n\t\toutputColumnLabel,\n\t\toutputTableLabel,\n\t\toutputTableDisabled,\n\t\tonChange,\n\t\tonChangeOutput: changeOutput,\n\t}) {\n\t\t/* Current Table Selection */\n\t\tconst tableId = s.input[NodeInput.Source]?.node\n\t\tconst table = useDataTable(tableId, g)\n\n\t\t/* Table Options */\n\t\tconst tables = useTableNames(g)\n\t\tconst tableOptions = useSimpleDropdownOptions(tables)\n\n\t\t/* Column Options */\n\t\tconst columns = useTableColumnNames(table, useColumnFilter(s, table))\n\t\tconst columnOptions = useSimpleDropdownOptions(columns)\n\n\t\t/* The step args component */\n\t\tconst StepArgs = useStepArgsComponent(s)\n\n\t\t/* Change Events */\n\t\tconst change = useStepChangeHandler(index, onChange)\n\t\tconst onInputTableChange = useInputTableChanged(s, g, change)\n\t\tconst onInputColumnChange = useInputColumnChanged(s, change)\n\t\tconst onOutputColumnChange = useOutputColumnChanged(s, change)\n\t\tconst onOutputTableChange = useOutputTableChanged(s, changeOutput, change)\n\n\t\t/* Side Effects */\n\t\tuseDefaultOutputNameInitially(s, output, changeOutput)\n\n\t\treturn StepArgs == null ? null : (\n\t\t\t<Container className=\"step-component\">\n\t\t\t\t{/* Input Table */}\n\t\t\t\t{isInputTableStep(s) ? (\n\t\t\t\t\t<TableDropdown\n\t\t\t\t\t\trequired\n\t\t\t\t\t\toptions={tableOptions}\n\t\t\t\t\t\tlabel={inputTableLabel || 'Input table'}\n\t\t\t\t\t\tselectedKey={tableId ?? null}\n\t\t\t\t\t\tonChange={onInputTableChange}\n\t\t\t\t\t/>\n\t\t\t\t) : null}\n\n\t\t\t\t{/* Input Column */}\n\t\t\t\t{isInputColumnStep(s) ? (\n\t\t\t\t\t<TableColumnDropdown\n\t\t\t\t\t\trequired\n\t\t\t\t\t\toptions={columnOptions}\n\t\t\t\t\t\tlabel={inputColumnLabel || `Column to ${s.verb}`}\n\t\t\t\t\t\tselectedKey={(s.args as InputColumnArgs).column}\n\t\t\t\t\t\tonChange={onInputColumnChange}\n\t\t\t\t\t/>\n\t\t\t\t) : null}\n\n\t\t\t\t<StepArgs\n\t\t\t\t\tstep={s}\n\t\t\t\t\tgraph={g}\n\t\t\t\t\toutput={output}\n\t\t\t\t\tonChangeOutput={changeOutput}\n\t\t\t\t\tonChange={change}\n\t\t\t\t/>\n\n\t\t\t\t{/* Output Column */}\n\t\t\t\t{isOutputColumnStep(s) ? (\n\t\t\t\t\t<TextField\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tlabel={outputColumnLabel || 'New column name'}\n\t\t\t\t\t\tplaceholder={'Column name'}\n\t\t\t\t\t\tvalue={(s.args as OutputColumnArgs).to}\n\t\t\t\t\t\tstyles={dropdownStyles}\n\t\t\t\t\t\tonChange={onOutputColumnChange}\n\t\t\t\t\t/>\n\t\t\t\t) : null}\n\n\t\t\t\t{/* Output Table */}\n\t\t\t\t<TextField\n\t\t\t\t\trequired\n\t\t\t\t\tdisabled={outputTableDisabled}\n\t\t\t\t\tlabel={outputTableLabel || 'Output table'}\n\t\t\t\t\tplaceholder={'Table name'}\n\t\t\t\t\tvalue={output ?? s.id}\n\t\t\t\t\tstyles={dropdownStyles}\n\t\t\t\t\tonChange={onOutputTableChange}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t)\n\t},\n)\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const Container = styled.div`\n\twidth: 240px;\n\tdisplay: flex;\n\talign-items: center;\n`\n\nexport const SearchContainer = styled.div`\n\tborder-bottom: 1px solid\n\t\t${({ theme }) => theme.application().lowContrast().hex()};\n`\n\nexport const icons = {\n\tadd: { iconName: 'Add' },\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { isOutputColumnStep } from '@datashaper/core'\nimport { NodeInput } from '@datashaper/dataflow'\nimport styled from '@essex/styled-components'\nimport isNil from 'lodash-es/isNil.js'\nimport { memo, useMemo } from 'react'\n\nimport type { DescriptionRow, VerbDescriptionProps } from '../types.js'\n\nfunction VerbDescriptionFn<T extends object | void>({\n\tstep,\n\trows,\n\toutput,\n\tshowInput,\n\tshowOutput,\n\tshowOutputColumn,\n\tstyle,\n}: VerbDescriptionProps<T>) {\n\tconst rws = useMemo(() => {\n\t\tfunction loop(rows: DescriptionRow[]) {\n\t\t\treturn rows.map((row, index) => (\n\t\t\t\t<Row\n\t\t\t\t\tkey={`verb-description-row-${row.value}-${index}`}\n\t\t\t\t\ttitle={row.title}\n\t\t\t\t>\n\t\t\t\t\t<KeyValue>\n\t\t\t\t\t\t{row.before ? <Key>{row.before}</Key> : null}\n\t\t\t\t\t\t{isNil(row.value) ? (\n\t\t\t\t\t\t\t<Unset />\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<Value title={row.value}>{row.value}</Value>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{row.after ? <Key>{row.after}</Key> : null}\n\t\t\t\t\t</KeyValue>\n\t\t\t\t\t{row.sub ? loop(row.sub) : null}\n\t\t\t\t</Row>\n\t\t\t))\n\t\t}\n\t\treturn loop(rows)\n\t}, [rows])\n\tconst shouldShowOutputColumn = showOutputColumn && isOutputColumnStep(step)\n\tconst input = step.input[NodeInput.Source]?.node\n\treturn (\n\t\t<Container style={style}>\n\t\t\t<Verb>{step.verb}</Verb>\n\t\t\t{showInput ? (\n\t\t\t\t<Row>\n\t\t\t\t\t<KeyValue>\n\t\t\t\t\t\t<Key>table</Key>\n\t\t\t\t\t\t{!input ? <Unset /> : <Value>{input}</Value>}\n\t\t\t\t\t</KeyValue>\n\t\t\t\t</Row>\n\t\t\t) : null}\n\t\t\t{rws}\n\t\t\t{showOutput ? (\n\t\t\t\t<Row>\n\t\t\t\t\t<KeyValue>\n\t\t\t\t\t\t<Key>into table</Key>\n\t\t\t\t\t\t{!output ? <Unset /> : <Value>{output}</Value>}\n\t\t\t\t\t</KeyValue>\n\t\t\t\t</Row>\n\t\t\t) : null}\n\t\t\t{shouldShowOutputColumn ? (\n\t\t\t\t<Row>\n\t\t\t\t\t<KeyValue>\n\t\t\t\t\t\t<Key>as column</Key>\n\t\t\t\t\t\t{!(step.args as any).to ? (\n\t\t\t\t\t\t\t<Unset />\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<Value>{(step.args as any).to}</Value>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</KeyValue>\n\t\t\t\t</Row>\n\t\t\t) : null}\n\t\t</Container>\n\t)\n}\n\nexport const VerbDescription = memo(VerbDescriptionFn)\n\nconst Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: flex-start;\n\tmin-height: 180px;\n`\n\nconst Verb = styled.div`\n\ttext-transform: uppercase;\n\tfont-weight: bold;\n\talign-items: center;\n\twidth: 100%;\n\tcolor: ${({ theme }) => theme.application().midContrast().hex()};\n`\n\nconst Row = styled.div`\n\tpadding-left: 8px;\n\tdisplay: flex;\n\tflex-direction: column;\n`\n\nconst KeyValue = styled.div`\n\tdisplay: flex;\n\tjustify-content: flex-start;\n\tgap: 4px;\n`\n\nconst Key = styled.div``\n\nconst Unset = styled.div`\n\tcolor: ${({ theme }) => theme.application().lowContrast().hex()};\n\t&:before {\n\t\tcontent: 'unset';\n\t}\n`\n\nconst Value = styled.div`\n\tmax-width: 240px;\n\ttext-overflow: ellipsis;\n\toverflow: hidden;\n\tfont-weight: bold;\n\tcolor: ${({ theme }) => theme.application().midContrast().hex()};\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport type { AggregateArgs } from '@datashaper/core'\nimport { memo, useMemo } from 'react'\n\nimport type { StepDescriptionProps } from '../types'\nimport { VerbDescription } from '../verbForm/VerbDescription.js'\n\nexport const AggregateDescription: React.FC<\n\tStepDescriptionProps<AggregateArgs>\n> = memo(function AggregateDescription(props) {\n\tconst rows = useMemo(() => {\n\t\tconst {\n\t\t\tstep: { args },\n\t\t} = props\n\t\treturn [\n\t\t\t{\n\t\t\t\tbefore: 'group by',\n\t\t\t\tvalue: args.groupby,\n\t\t\t},\n\t\t\t{\n\t\t\t\tbefore: 'rollup column',\n\t\t\t\tvalue: args.column,\n\t\t\t\tsub: [\n\t\t\t\t\t{\n\t\t\t\t\t\tbefore: 'with function',\n\t\t\t\t\t\tvalue: args.operation,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t]\n\t}, [props])\n\treturn <VerbDescription {...props} rows={rows} />\n})\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport type { IDropdownStyles } from '@fluentui/react'\nimport styled from 'styled-components'\n\nexport const dropdownStyles: Partial<IDropdownStyles> = {\n\tdropdown: { marginTop: '4px' },\n}\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\tpadding: 0 12px 12px;\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\theight: 170px;\n\tmargin-bottom: 2rem;\n`\n\nexport const Examples = styled.div``\nexport const ExamplesContainer = styled.div``\n\nexport const Description = styled.div`\n\twidth: 400px;\n\tflex-direction: column;\n\tjustify-content: center;\n`\n\nexport const ControlBlock = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 8px;\n`\n\nexport const Control = styled.div`\n\twidth: 200px;\n`\n\nexport const DropBlock = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\theight: 100%;\n\tgap: 10px;\n`\n\nexport const Drop = styled.div`\n\twidth: 160px;\n\theight: 50px;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from 'styled-components'\n\nexport const Container = styled.div`\n\twidth: 500px;\n\theight: 300px;\n\tborder: 1px solid ${({ theme }) => theme.application().faint().hex()};\n`\n\nexport const TableContainer = styled.div`\n\theight: 264px;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { ArqueroDetailsList, ArqueroTableHeader } from '@datashaper/react'\nimport type { IColumn, IDropdownOption } from '@fluentui/react'\nimport { memo, useCallback, useEffect, useState } from 'react'\n\nimport { useColumns, useCommandBar, useFarCommandBar } from './Table.hooks.js'\nimport { Container, TableContainer } from './Table.styles.js'\nimport type { TableProps } from './Table.types.js'\n\nexport const Table: React.FC<TableProps> = memo(function Table({\n\tname,\n\ttable,\n\tconfig = {},\n\tfeatures = {},\n\tcompact,\n\tonRenameTable,\n}) {\n\tconst [selectedColumn, setSelectedColumn] = useState<string | undefined>()\n\tconst [visibleColumns, setVisibleColumns] = useState<string[]>(\n\t\ttable.columnNames(),\n\t)\n\tuseEffect(() => {\n\t\tsetVisibleColumns(table.columnNames())\n\t}, [table, setVisibleColumns])\n\n\tconst columns = useColumns(config)\n\tconst commandBar = useCommandBar(table, visibleColumns, setVisibleColumns)\n\tconst farCommandBar = useFarCommandBar(table)\n\n\tconst handleColumnClick = useCallback(\n\t\t(evt?: React.MouseEvent<HTMLElement>, column?: IColumn) =>\n\t\t\tsetSelectedColumn(column?.key),\n\t\t[setSelectedColumn],\n\t)\n\n\tconst handleCellDropdownSelect = useCallback(\n\t\t(\n\t\t\tevt: React.FormEvent<HTMLDivElement>,\n\t\t\toption?: IDropdownOption<any> | undefined,\n\t\t) => {\n\t\t\tconsole.log('option selected: ', option)\n\t\t\talert(`Value selected: ${option?.text}`)\n\t\t},\n\t\t[],\n\t)\n\n\treturn (\n\t\t<Container className=\"table-container\">\n\t\t\t<ArqueroTableHeader\n\t\t\t\ttable={table}\n\t\t\t\tname={name}\n\t\t\t\tshowRowCount={true}\n\t\t\t\tshowColumnCount={true}\n\t\t\t\tcommandBar={commandBar}\n\t\t\t\tfarCommandBar={farCommandBar}\n\t\t\t\tvisibleColumns={visibleColumns}\n\t\t\t\tonRenameTable={onRenameTable}\n\t\t\t/>\n\t\t\t<TableContainer>\n\t\t\t\t<ArqueroDetailsList\n\t\t\t\t\ttable={table}\n\t\t\t\t\tcolumns={columns}\n\t\t\t\t\tfeatures={features}\n\t\t\t\t\tcompact={compact}\n\t\t\t\t\tselectedColumn={selectedColumn}\n\t\t\t\t\tonColumnClick={handleColumnClick}\n\t\t\t\t\tonCellDropdownSelect={handleCellDropdownSelect}\n\t\t\t\t\tisColumnClickable\n\t\t\t\t\tisSortable\n\t\t\t\t\tshowColumnBorders\n\t\t\t\t\tisHeadersFixed\n\t\t\t\t\tvisibleColumns={visibleColumns}\n\t\t\t\t/>\n\t\t\t</TableContainer>\n\t\t</Container>\n\t)\n})\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { Separator } from '@fluentui/react'\nimport styled from 'styled-components'\n\nexport const Container = styled.section`\n\twidth: 100%;\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: flex-start;\n\tmargin-bottom: 40px;\n`\n\nexport const Titles = styled.div`\n\twidth: 200px;\n\ttext-align: right;\n\ttext-transform: uppercase;\n`\n\nexport const H1 = styled.h1`\n\tmargin-top: 0;\n\tmargin-bottom: 0;\n\tcolor: ${({ theme }) => theme.application().lowContrast().hex()};\n`\n\nexport const H2 = styled.h2`\n\tmargin-top: 0;\n\tmargin-bottom: 0;\n\tcolor: ${({ theme }) => theme.application().accent().hex()};\n`\n\nexport const StyledSeparator = styled(Separator)`\n\tmargin-left: 8px;\n\tmargin-right: 36px;\n`\n\nexport const ChildrenContainer = styled.div`\n\tdisplay: flex;\n\tjustify-content: space-between;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { memo } from 'react'\n\nimport {\n\tChildrenContainer,\n\tContainer,\n\tH1,\n\tH2,\n\tStyledSeparator,\n\tTitles,\n} from './Section.styles.js'\nimport type { SectionProps } from './Section.types.js'\n\nexport const Section: React.FC<React.PropsWithChildren<SectionProps>> = memo(\n\tfunction Section({ title, subtitle, children }) {\n\t\treturn (\n\t\t\t<Container className=\"section\">\n\t\t\t\t<Titles>\n\t\t\t\t\t<H1>{title}</H1>\n\t\t\t\t\t<H2>{subtitle}</H2>\n\t\t\t\t</Titles>\n\t\t\t\t<StyledSeparator vertical />\n\t\t\t\t<ChildrenContainer>{children}</ChildrenContainer>\n\t\t\t</Container>\n\t\t)\n\t},\n)\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { memo, useMemo } from 'react'\n\nimport { selectStepDescription } from '../selectStepDescription.js'\nimport { Container } from './StepDescription.styles.js'\nimport type { StepDescriptionProps } from './StepDescription.types.js'\n\n/**\n * Let's us render the Steps in a loop while memoing all the functions\n */\nexport const StepDescription: React.FC<StepDescriptionProps> = memo(\n\tfunction StepComponent({ step, output }) {\n\t\tconst Description = useMemo(() => selectStepDescription(step), [step])\n\n\t\treturn (\n\t\t\t<Container>\n\t\t\t\t<Description\n\t\t\t\t\tstep={step}\n\t\t\t\t\toutput={output}\n\t\t\t\t\tshowInput\n\t\t\t\t\tshowOutput\n\t\t\t\t\tshowOutputColumn\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t)\n\t},\n)\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from 'styled-components'\n\nexport const columnsStyle = {\n\tID: {\n\t\twidth: 50,\n\t\ticonName: 'FavoriteStarFill',\n\t},\n}\n\nexport const StepBlock = styled.div`\n\tdisplay: flex;\n`\n\nexport const StepsColumn = styled.div`\n\twidth: 250px;\n`\n\nexport const OutputsColumn = styled.div`\n\tmargin-left: 40px;\n\tdisplay: flex;\n\tflex-direction: column;\n`\n\nexport const TableSection = styled.div`\n\tmax-height: 400px;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { StepComponent, StepDescription, useDataTable } from '@datashaper/react'\nimport { memo } from 'react'\n\nimport { Section } from './Section.js'\nimport {\n\tcolumnsStyle,\n\tOutputsColumn,\n\tStepBlock,\n\tStepsColumn,\n\tTableSection,\n} from './StepOutput.styles.js'\nimport type { StepOutputProps } from './StepOutput.types.js'\nimport { Table } from './Table.js'\n\nexport const StepOutput: React.FC<StepOutputProps> = memo(function StepOutput({\n\tstep,\n\tindex,\n\tgraph,\n\toutput,\n\tfeatures,\n\tcompact,\n\tonStepChange,\n\tonStepOutputChange,\n}) {\n\tconst table = useDataTable(output, graph)\n\n\treturn (\n\t\t<StepBlock className=\"step-block\">\n\t\t\t<Section title={`Step ${index + 1}`} subtitle={step.verb}>\n\t\t\t\t<StepsColumn className=\"steps-column\">\n\t\t\t\t\t<StepComponent\n\t\t\t\t\t\tstep={step}\n\t\t\t\t\t\tgraph={graph}\n\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\toutput={output}\n\t\t\t\t\t\tonChange={onStepChange}\n\t\t\t\t\t\tonChangeOutput={o => onStepOutputChange(step, o)}\n\t\t\t\t\t/>\n\t\t\t\t</StepsColumn>\n\t\t\t\t<StepDescription step={step} output={output} />\n\t\t\t\t<OutputsColumn className=\"outputs-column\">\n\t\t\t\t\t{table ? (\n\t\t\t\t\t\t<TableSection className=\"table-section\">\n\t\t\t\t\t\t\t<Table\n\t\t\t\t\t\t\t\tname={output}\n\t\t\t\t\t\t\t\ttable={table}\n\t\t\t\t\t\t\t\tconfig={columnsStyle}\n\t\t\t\t\t\t\t\tfeatures={features}\n\t\t\t\t\t\t\t\tcompact={compact}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</TableSection>\n\t\t\t\t\t) : null}\n\t\t\t\t</OutputsColumn>\n\t\t\t</Section>\n\t\t</StepBlock>\n\t)\n})\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from 'styled-components'\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: flex-start;\n\tpadding: 0px 20px 0px 20px;\n`\n\nexport const Workspace = styled.div`\n\twidth: 100%;\n`\n\nexport const Commands = styled.div`\n\twidth: 200px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 12px;\n\tjustify-content: space-between;\n`\n\nexport const Buttons = styled.div`\n\twidth: 100%;\n\tdisplay: flex;\n\tjustify-content: space-between;\n`\nexport const InputsSection = styled.div`\n\tmargin-bottom: 80px;\n`\n\nexport const icons = {\n\tdownload: { iconName: 'Download' },\n}\n\nexport const columnsStyle = {\n\tID: {\n\t\twidth: 50,\n\t\ticonName: 'FavoriteStarFill',\n\t},\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const Container = styled.div`\n\twidth: 97%;\n\tdisplay: grid;\n`\n\n// HACK\nexport const modalStyles = { calloutMain: { overflow: 'hidden' } } as any\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\nimport { DocumentCard } from '@fluentui/react'\n\nexport const styles = {\n\tcard: {\n\t\troot: {\n\t\t\tminWidth: 'unset',\n\t\t},\n\t},\n\tactions: { root: { padding: 'unset' } },\n}\n\nexport const CardContent = styled.div`\n\tpadding: 8px;\n`\n\nexport const Card = styled(DocumentCard)`\n\tmin-width: fit-content;\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: space-between;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { DocumentCardActions } from '@fluentui/react'\nimport { memo, useMemo } from 'react'\n\nimport { selectStepDescription } from '../selectStepDescription.js'\nimport { useStepActions } from './StepCard.hooks.js'\nimport { Card,CardContent, styles } from './StepCard.styles.js'\nimport type { StepCardProps } from './StepCard.types.js'\n\nexport const StepCard: React.FC<StepCardProps> = memo(function StepCard({\n\tstep,\n\tindex,\n\toutput,\n\tonEdit,\n\tonDelete,\n\tonDuplicate,\n\tonSelect,\n}) {\n\tconst Description = useMemo(() => selectStepDescription(step), [step])\n\tconst stepActions = useStepActions(\n\t\tstep,\n\t\tindex,\n\t\tonEdit,\n\t\tonDelete,\n\t\tonDuplicate,\n\t\tonSelect,\n\t)\n\n\treturn (\n\t\t<Card styles={styles.card}>\n\t\t\t<CardContent>\n\t\t\t\t<Description\n\t\t\t\t\tstep={step}\n\t\t\t\t\toutput={output}\n\t\t\t\t\tshowInput\n\t\t\t\t\tshowOutput\n\t\t\t\t\tshowOutputColumn\n\t\t\t\t/>\n\t\t\t</CardContent>\n\t\t\t<DocumentCardActions\n\t\t\t\tclassName={`step-card-${index}`}\n\t\t\t\tstyles={styles.actions}\n\t\t\t\tactions={stepActions}\n\t\t\t/>\n\t\t</Card>\n\t)\n})\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const Text = styled.div`\n\tcolor: ${({ theme }) => theme.application?.().midContrast().hex()};\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { memo } from 'react'\n\nimport { Text } from './DetailText.styles.js'\nimport type { DetailTextProps } from './DetailText.types.js'\n\nexport const DetailText: React.FC<DetailTextProps> = memo(function DetailText({\n\ttext,\n\tstyle,\n}) {\n\treturn <Text style={style}>{text}</Text>\n})\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const addButtonStyles = {\n\troot: { padding: '0 4px 0 6px', whiteSpace: 'nowrap' },\n}\n\nexport const icons = {\n\tadd: { iconName: 'Add' },\n}\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\toverflow: auto;\n\tcolumn-gap: 12px;\n`\n\nexport const ButtonContainer = styled.div`\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 18px;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { DefaultButton } from '@fluentui/react'\nimport { memo, useEffect, useRef } from 'react'\n\nimport { StepCard } from '../index.js'\nimport { DetailText } from './DetailText.js'\nimport {\n\taddButtonStyles,\n\tButtonContainer,\n\tContainer,\n\ticons,\n} from './StepList.styles.js'\nimport type { StepListProps } from './StepList.types.js'\n\nexport const StepList: React.FC<StepListProps> = memo(function StepsList({\n\tsteps,\n\toutputs,\n\tonDeleteClicked,\n\tonEditClicked,\n\tonDuplicateClicked,\n\tonSelect,\n\tonStartNewStep,\n\tbuttonId,\n}) {\n\tconst ref = useRef<HTMLDivElement>(null)\n\tuseEffect(() => {\n\t\tconst f = () => {\n\t\t\tref?.current?.scrollIntoView(false)\n\t\t}\n\t\tf()\n\t}, [steps])\n\n\treturn (\n\t\t<Container>\n\t\t\t{steps.map((step, index) => {\n\t\t\t\treturn (\n\t\t\t\t\t<StepCard\n\t\t\t\t\t\toutput={outputs[index]}\n\t\t\t\t\t\tonDelete={onDeleteClicked}\n\t\t\t\t\t\tonEdit={onEditClicked}\n\t\t\t\t\t\tonDuplicate={onDuplicateClicked}\n\t\t\t\t\t\tonSelect={onSelect}\n\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\tstep={step}\n\t\t\t\t\t\tindex={index}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t})}\n\n\t\t\t{onStartNewStep && (\n\t\t\t\t<ButtonContainer ref={ref}>\n\t\t\t\t\t<DefaultButton\n\t\t\t\t\t\tstyles={addButtonStyles}\n\t\t\t\t\t\ticonProps={icons.add}\n\t\t\t\t\t\tonClick={onStartNewStep}\n\t\t\t\t\t\tid={buttonId}\n\t\t\t\t\t>\n\t\t\t\t\t\tAdd step\n\t\t\t\t\t</DefaultButton>\n\t\t\t\t\t{!steps?.length && (\n\t\t\t\t\t\t<DetailText text=\"Add your first preparation step\" />\n\t\t\t\t\t)}\n\t\t\t\t</ButtonContainer>\n\t\t\t)}\n\t\t</Container>\n\t)\n})\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const icons = {\n\tcancel: { iconName: 'Cancel' },\n\tinfo: { iconName: 'Info' },\n}\n\nconst MAX_HEIGHT = 700\n\nexport const ContainerBody = styled.div<{ showGuidance: boolean }>`\n\tpadding: 0px 12px 14px 24px;\n\tdisplay: flex;\n\tjustify-content: flex-start;\n\tgap: 12px;\n`\n\nexport const Header = styled.div`\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tbackground: ${({ theme }) => theme.application().faint().hex()};\n\tmargin-bottom: 12px;\n`\n\nexport const Title = styled.h3`\n\tpadding-left: 12px;\n\tmargin: 8px 0 8px 0;\n`\n\nexport const StepComponentContainer = styled.div`\n\twidth: 470px;\n\tmax-height: ${MAX_HEIGHT}px;\n\toverflow: hidden auto;\n`\n\nexport const StepSelectorContainer = styled.div`\n\tmargin-bottom: 8px;\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n`\n\nexport const ButtonContainer = styled.div`\n\tmargin-top: 8px;\n`\n\nexport const GuidanceContainer = styled.div`\n\twidth: 400px;\n\tmax-height: ${MAX_HEIGHT - 20}px;\n\toverflow: hidden auto;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport type { GraphManager } from '@datashaper/core'\nimport { default as guidanceIndex } from '@datashaper/verb-guidance'\nimport {\n\tCallout,\n\tDirectionalHint,\n\tIconButton,\n\tPrimaryButton,\n} from '@fluentui/react'\nimport { useBoolean } from '@fluentui/react-hooks'\nimport { memo } from 'react'\n\nimport { Guidance } from './Guidance.js'\nimport { StepComponent } from './StepComponent.js'\nimport { StepSelector } from './StepSelector.js'\nimport {\n\tuseHandleSaveClick,\n\tuseInternalTableStep,\n\tuseModalStyles,\n\tuseStepOutputHandling,\n} from './TableTransformModal.hooks.js'\nimport {\n\tButtonContainer,\n\tContainerBody,\n\tGuidanceContainer,\n\tHeader,\n\ticons,\n\tStepComponentContainer,\n\tStepSelectorContainer,\n\tTitle,\n} from './TableTransformModal.styles.js'\nimport type { TransformModalProps } from './TableTransformModal.types.js'\n\nexport const TableTransformModal: React.FC<TransformModalProps> = memo(\n\tfunction TableTransformModal({\n\t\tonDismiss,\n\t\tgraph,\n\t\tonTransformRequested,\n\t\tindex,\n\t\tstep,\n\t\tnextInputTable,\n\t\tstyles,\n\t\t...props\n\t}) {\n\t\tconst [showGuidance, { toggle: toggleGuidance }] = useBoolean(false)\n\t\tconst { internal, setInternal, handleVerbChange } = useInternalTableStep(\n\t\t\tstep,\n\t\t\tnextInputTable,\n\t\t\tgraph as GraphManager,\n\t\t)\n\n\t\tconst adaptedStyles = useModalStyles(styles, showGuidance)\n\t\tconst { output, onOutputChanged } = useStepOutputHandling(graph, step)\n\t\tconst handleSaveClick = useHandleSaveClick(\n\t\t\tinternal,\n\t\t\toutput,\n\t\t\tonTransformRequested,\n\t\t)\n\n\t\treturn (\n\t\t\t<Callout\n\t\t\t\tonDismissed={() => setInternal(undefined)}\n\t\t\t\tstyles={adaptedStyles}\n\t\t\t\tdirectionalHint={DirectionalHint.rightBottomEdge}\n\t\t\t\t{...props}\n\t\t\t>\n\t\t\t\t<Header>\n\t\t\t\t\t<Title>{step ? 'Edit step' : 'New step'}</Title>\n\t\t\t\t\t{onDismiss && (\n\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\ticonProps={icons.cancel}\n\t\t\t\t\t\t\tariaLabel=\"Close popup modal\"\n\t\t\t\t\t\t\tonClick={() => onDismiss()}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</Header>\n\n\t\t\t\t<ContainerBody showGuidance={showGuidance}>\n\t\t\t\t\t<StepComponentContainer>\n\t\t\t\t\t\t<StepSelectorContainer>\n\t\t\t\t\t\t\t<StepSelector\n\t\t\t\t\t\t\t\tplaceholder=\"Select a verb\"\n\t\t\t\t\t\t\t\tverb={internal?.verb}\n\t\t\t\t\t\t\t\tonCreate={handleVerbChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{internal?.verb ? (\n\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\tonClick={toggleGuidance}\n\t\t\t\t\t\t\t\t\ticonProps={icons.info}\n\t\t\t\t\t\t\t\t\tchecked={showGuidance}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t</StepSelectorContainer>\n\t\t\t\t\t\t{internal && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<StepComponent\n\t\t\t\t\t\t\t\t\tstep={internal}\n\t\t\t\t\t\t\t\t\tgraph={graph}\n\t\t\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\t\t\toutput={output}\n\t\t\t\t\t\t\t\t\tonChangeOutput={onOutputChanged}\n\t\t\t\t\t\t\t\t\tonChange={setInternal}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<ButtonContainer>\n\t\t\t\t\t\t\t\t\t<PrimaryButton onClick={handleSaveClick}>Save</PrimaryButton>\n\t\t\t\t\t\t\t\t</ButtonContainer>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</StepComponentContainer>\n\t\t\t\t\t{showGuidance && internal?.verb ? (\n\t\t\t\t\t\t<GuidanceContainer>\n\t\t\t\t\t\t\t<Guidance name={internal?.verb} index={guidanceIndex} />\n\t\t\t\t\t\t</GuidanceContainer>\n\t\t\t\t\t) : null}\n\t\t\t\t</ContainerBody>\n\t\t\t</Callout>\n\t\t)\n\t},\n)\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nconst GAP = 18\nconst INPUT_HEIGHT = 60\nconst STEPS_HEIGHT = 280\nconst COLLAPSED_STEPS_HEIGHT = 50\n\nexport const SectionTitle = styled.span<{ isCollapsed?: boolean }>`\n\tmargin: 0 ${GAP}px 0 ${GAP}px;\n\tfont-weight: bold;\n\twriting-mode: vertical-rl;\n\tfont-size: 15px;\n\talign-self: center;\n\ttext-transform: uppercase;\n\tcolor: ${({ theme }) => theme.application().lowMidContrast().hex()};\n\ttransform: ${({ isCollapsed }) =>\n\t\tisCollapsed ? 'translate(2rem, 0) rotate(-90deg)' : 'rotate(180deg)'};\n\tcursor: pointer;\n\tdisplay: flex;\n\tgap: 0.5rem;\n\talign-items: center;\n`\n\nexport const Container = styled.div`\n\tdisplay: flex;\n\tflex-flow: column;\n\theight: 100%;\n\twidth: 100%;\n\tpadding: ${GAP}px 0 ${GAP}px 0;\n\tgap: ${GAP}px;\n\tposition: relative;\n`\n\nexport const InputContainer = styled.div`\n\tdisplay: flex;\n\tmin-height: ${INPUT_HEIGHT}px;\n\tflex: 0 1 ${INPUT_HEIGHT}px;\n\tpadding-right: ${GAP}px;\n\torder: 1;\n`\n\nexport const OutputContainer = styled.div<{\n\tstepsPosition: string\n\tisCollapsed: boolean\n}>`\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\tpadding-right: ${GAP}px;\n\tmax-height: ${({ isCollapsed }) =>\n\t\t`calc(100% - ${\n\t\t\tINPUT_HEIGHT + (isCollapsed ? 0 : STEPS_HEIGHT) + GAP * 4\n\t\t}px)`};\n\torder: ${({ stepsPosition }) => (stepsPosition === 'bottom' ? 2 : 3)};\n`\n\nexport const StepsTrayContainer = styled.div<{\n\tstepsPosition: string\n\tisCollapsed: boolean\n}>`\n\tdisplay: flex;\n\tmin-height: ${({ isCollapsed }) =>\n\t\tisCollapsed ? 'unset' : STEPS_HEIGHT + 'px'};\n\tbackground-color: ${({ theme }) => theme.application().faint().hex()};\n\tpadding: 0;\n\torder: ${({ stepsPosition }) => (stepsPosition === 'bottom' ? 3 : 2)};\n\theight: ${({ isCollapsed }) =>\n\t\tisCollapsed ? COLLAPSED_STEPS_HEIGHT + 'px' : 'auto'};\n\toverflow: ${({ isCollapsed }) => (isCollapsed ? 'hidden' : 'auto hidden')};\n\t> div {\n\t\tdisplay: ${({ isCollapsed }) => (isCollapsed ? 'none' : 'grid')};\n\t}\n`\nexport const WorkflowContainer = styled.div`\n\tdisplay: flex;\n\theight: 100%;\n\twidth: 100%;\n\talign-items: center;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const Container = styled.div`\n\toverflow: auto;\n\tdisplay: flex;\n\tflex-direction: column;\n\theight: 100%;\n\tborder: 1px solid ${({ theme }) => theme.application().faint().hex()};\n`\n\nexport const TextContainer = styled.div`\n\tdisplay: flex;\n\theight: 100%;\n\talign-items: center;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\n\nimport { memo } from 'react'\n\nimport {\n\tArqueroDetailsList,\n\tStatsColumnType,\n} from './ArqueroDetailsList/index.js'\nimport { ArqueroTableHeader } from './ArqueroTableHeader/index.js'\nimport { DetailText } from './DetailText.js'\nimport { useToggleTableFeatures } from './PreviewTable.hooks.js'\nimport { Container, TextContainer } from './PreviewTable.styles.js'\nimport type { PreviewTableProps } from './PreviewTable.types.js'\n\nconst statsColumnTypes = [\n\tStatsColumnType.Type,\n\tStatsColumnType.Min,\n\tStatsColumnType.Max,\n\tStatsColumnType.Distinct,\n\tStatsColumnType.Invalid,\n]\n\nexport const PreviewTable: React.FC<PreviewTableProps> = memo(\n\tfunction PreviewTable({\n\t\ttable,\n\t\theaderCommandBar,\n\t\tname,\n\t\tmetadata,\n\t\tonChangeMetadata,\n\t}) {\n\t\tconst { tableFeatures } = useToggleTableFeatures()\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{table ? (\n\t\t\t\t\t<Container>\n\t\t\t\t\t\t<ArqueroTableHeader name={name} table={table} />\n\t\t\t\t\t\t<ArqueroDetailsList\n\t\t\t\t\t\t\tisSortable\n\t\t\t\t\t\t\tcompact\n\t\t\t\t\t\t\tshowColumnBorders\n\t\t\t\t\t\t\tisHeadersFixed\n\t\t\t\t\t\t\tmetadata={metadata}\n\t\t\t\t\t\t\tonChangeMetadata={onChangeMetadata}\n\t\t\t\t\t\t\tfeatures={{\n\t\t\t\t\t\t\t\t...tableFeatures,\n\t\t\t\t\t\t\t\tstatsColumnTypes: statsColumnTypes,\n\t\t\t\t\t\t\t\tcommandBar: headerCommandBar ? headerCommandBar : undefined,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ttable={table}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Container>\n\t\t\t\t) : (\n\t\t\t\t\t<TextContainer>\n\t\t\t\t\t\t<DetailText text=\"(No table selected)\" />\n\t\t\t\t\t</TextContainer>\n\t\t\t\t)}\n\t\t\t</>\n\t\t)\n\t},\n)\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from '@essex/styled-components'\n\nexport const ListContainer = styled.div`\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: flex-start;\n\talign-items: center;\n\twidth: 100%;\n\tgap: 18px;\n`\n\nexport const viewButtonStyles = { root: { padding: '0 4px 0 6px' } }\n\nexport const icons = {\n\tview: { iconName: 'View' },\n}\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from 'styled-components'\n\nexport const Container = styled.div`\n\theight: calc(100vh - 80px);\n\tposition: relative;\n`\n\nexport const Wrapper = styled.div`\n\theight: 90%;\n`\n\nexport const mgmtStyles = {\n\troot: {\n\t\theight: 36,\n\t\tpaddingLeft: 9,\n\t},\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reportTypeError = exports.checkDataTypes = exports.checkDataType = exports.coerceAndCheckDataType = exports.getJSONTypes = exports.getSchemaTypes = exports.DataType = void 0;\nconst rules_1 = require(\"../rules\");\nconst applicability_1 = require(\"./applicability\");\nconst errors_1 = require(\"../errors\");\nconst codegen_1 = require(\"../codegen\");\nconst util_1 = require(\"../util\");\nvar DataType;\n(function (DataType) {\n    DataType[DataType[\"Correct\"] = 0] = \"Correct\";\n    DataType[DataType[\"Wrong\"] = 1] = \"Wrong\";\n})(DataType = exports.DataType || (exports.DataType = {}));\nfunction getSchemaTypes(schema) {\n    const types = getJSONTypes(schema.type);\n    const hasNull = types.includes(\"null\");\n    if (hasNull) {\n        if (schema.nullable === false)\n            throw new Error(\"type: null contradicts nullable: false\");\n    }\n    else {\n        if (!types.length && schema.nullable !== undefined) {\n            throw new Error('\"nullable\" cannot be used without \"type\"');\n        }\n        if (schema.nullable === true)\n            types.push(\"null\");\n    }\n    return types;\n}\nexports.getSchemaTypes = getSchemaTypes;\nfunction getJSONTypes(ts) {\n    const types = Array.isArray(ts) ? ts : ts ? [ts] : [];\n    if (types.every(rules_1.isJSONType))\n        return types;\n    throw new Error(\"type must be JSONType or JSONType[]: \" + types.join(\",\"));\n}\nexports.getJSONTypes = getJSONTypes;\nfunction coerceAndCheckDataType(it, types) {\n    const { gen, data, opts } = it;\n    const coerceTo = coerceToTypes(types, opts.coerceTypes);\n    const checkTypes = types.length > 0 &&\n        !(coerceTo.length === 0 && types.length === 1 && (0, applicability_1.schemaHasRulesForType)(it, types[0]));\n    if (checkTypes) {\n        const wrongType = checkDataTypes(types, data, opts.strictNumbers, DataType.Wrong);\n        gen.if(wrongType, () => {\n            if (coerceTo.length)\n                coerceData(it, types, coerceTo);\n            else\n                reportTypeError(it);\n        });\n    }\n    return checkTypes;\n}\nexports.coerceAndCheckDataType = coerceAndCheckDataType;\nconst COERCIBLE = new Set([\"string\", \"number\", \"integer\", \"boolean\", \"null\"]);\nfunction coerceToTypes(types, coerceTypes) {\n    return coerceTypes\n        ? types.filter((t) => COERCIBLE.has(t) || (coerceTypes === \"array\" && t === \"array\"))\n        : [];\n}\nfunction coerceData(it, types, coerceTo) {\n    const { gen, data, opts } = it;\n    const dataType = gen.let(\"dataType\", (0, codegen_1._) `typeof ${data}`);\n    const coerced = gen.let(\"coerced\", (0, codegen_1._) `undefined`);\n    if (opts.coerceTypes === \"array\") {\n        gen.if((0, codegen_1._) `${dataType} == 'object' && Array.isArray(${data}) && ${data}.length == 1`, () => gen\n            .assign(data, (0, codegen_1._) `${data}[0]`)\n            .assign(dataType, (0, codegen_1._) `typeof ${data}`)\n            .if(checkDataTypes(types, data, opts.strictNumbers), () => gen.assign(coerced, data)));\n    }\n    gen.if((0, codegen_1._) `${coerced} !== undefined`);\n    for (const t of coerceTo) {\n        if (COERCIBLE.has(t) || (t === \"array\" && opts.coerceTypes === \"array\")) {\n            coerceSpecificType(t);\n        }\n    }\n    gen.else();\n    reportTypeError(it);\n    gen.endIf();\n    gen.if((0, codegen_1._) `${coerced} !== undefined`, () => {\n        gen.assign(data, coerced);\n        assignParentData(it, coerced);\n    });\n    function coerceSpecificType(t) {\n        switch (t) {\n            case \"string\":\n                gen\n                    .elseIf((0, codegen_1._) `${dataType} == \"number\" || ${dataType} == \"boolean\"`)\n                    .assign(coerced, (0, codegen_1._) `\"\" + ${data}`)\n                    .elseIf((0, codegen_1._) `${data} === null`)\n                    .assign(coerced, (0, codegen_1._) `\"\"`);\n                return;\n            case \"number\":\n                gen\n                    .elseIf((0, codegen_1._) `${dataType} == \"boolean\" || ${data} === null\n              || (${dataType} == \"string\" && ${data} && ${data} == +${data})`)\n                    .assign(coerced, (0, codegen_1._) `+${data}`);\n                return;\n            case \"integer\":\n                gen\n                    .elseIf((0, codegen_1._) `${dataType} === \"boolean\" || ${data} === null\n              || (${dataType} === \"string\" && ${data} && ${data} == +${data} && !(${data} % 1))`)\n                    .assign(coerced, (0, codegen_1._) `+${data}`);\n                return;\n            case \"boolean\":\n                gen\n                    .elseIf((0, codegen_1._) `${data} === \"false\" || ${data} === 0 || ${data} === null`)\n                    .assign(coerced, false)\n                    .elseIf((0, codegen_1._) `${data} === \"true\" || ${data} === 1`)\n                    .assign(coerced, true);\n                return;\n            case \"null\":\n                gen.elseIf((0, codegen_1._) `${data} === \"\" || ${data} === 0 || ${data} === false`);\n                gen.assign(coerced, null);\n                return;\n            case \"array\":\n                gen\n                    .elseIf((0, codegen_1._) `${dataType} === \"string\" || ${dataType} === \"number\"\n              || ${dataType} === \"boolean\" || ${data} === null`)\n                    .assign(coerced, (0, codegen_1._) `[${data}]`);\n        }\n    }\n}\nfunction assignParentData({ gen, parentData, parentDataProperty }, expr) {\n    // TODO use gen.property\n    gen.if((0, codegen_1._) `${parentData} !== undefined`, () => gen.assign((0, codegen_1._) `${parentData}[${parentDataProperty}]`, expr));\n}\nfunction checkDataType(dataType, data, strictNums, correct = DataType.Correct) {\n    const EQ = correct === DataType.Correct ? codegen_1.operators.EQ : codegen_1.operators.NEQ;\n    let cond;\n    switch (dataType) {\n        case \"null\":\n            return (0, codegen_1._) `${data} ${EQ} null`;\n        case \"array\":\n            cond = (0, codegen_1._) `Array.isArray(${data})`;\n            break;\n        case \"object\":\n            cond = (0, codegen_1._) `${data} && typeof ${data} == \"object\" && !Array.isArray(${data})`;\n            break;\n        case \"integer\":\n            cond = numCond((0, codegen_1._) `!(${data} % 1) && !isNaN(${data})`);\n            break;\n        case \"number\":\n            cond = numCond();\n            break;\n        default:\n            return (0, codegen_1._) `typeof ${data} ${EQ} ${dataType}`;\n    }\n    return correct === DataType.Correct ? cond : (0, codegen_1.not)(cond);\n    function numCond(_cond = codegen_1.nil) {\n        return (0, codegen_1.and)((0, codegen_1._) `typeof ${data} == \"number\"`, _cond, strictNums ? (0, codegen_1._) `isFinite(${data})` : codegen_1.nil);\n    }\n}\nexports.checkDataType = checkDataType;\nfunction checkDataTypes(dataTypes, data, strictNums, correct) {\n    if (dataTypes.length === 1) {\n        return checkDataType(dataTypes[0], data, strictNums, correct);\n    }\n    let cond;\n    const types = (0, util_1.toHash)(dataTypes);\n    if (types.array && types.object) {\n        const notObj = (0, codegen_1._) `typeof ${data} != \"object\"`;\n        cond = types.null ? notObj : (0, codegen_1._) `!${data} || ${notObj}`;\n        delete types.null;\n        delete types.array;\n        delete types.object;\n    }\n    else {\n        cond = codegen_1.nil;\n    }\n    if (types.number)\n        delete types.integer;\n    for (const t in types)\n        cond = (0, codegen_1.and)(cond, checkDataType(t, data, strictNums, correct));\n    return cond;\n}\nexports.checkDataTypes = checkDataTypes;\nconst typeError = {\n    message: ({ schema }) => `must be ${schema}`,\n    params: ({ schema, schemaValue }) => typeof schema == \"string\" ? (0, codegen_1._) `{type: ${schema}}` : (0, codegen_1._) `{type: ${schemaValue}}`,\n};\nfunction reportTypeError(it) {\n    const cxt = getTypeErrorContext(it);\n    (0, errors_1.reportError)(cxt, typeError);\n}\nexports.reportTypeError = reportTypeError;\nfunction getTypeErrorContext(it) {\n    const { gen, data, schema } = it;\n    const schemaCode = (0, util_1.schemaRefOrVal)(it, schema, \"type\");\n    return {\n        gen,\n        keyword: \"type\",\n        data,\n        schema: schema.type,\n        schemaCode,\n        schemaValue: schemaCode,\n        parentSchema: schema,\n        params: {},\n        it,\n    };\n}\n//# sourceMappingURL=dataType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.validateSchemaDeps = exports.validatePropertyDeps = exports.error = void 0;\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst code_1 = require(\"../code\");\nexports.error = {\n    message: ({ params: { property, depsCount, deps } }) => {\n        const property_ies = depsCount === 1 ? \"property\" : \"properties\";\n        return (0, codegen_1.str) `must have ${property_ies} ${deps} when property ${property} is present`;\n    },\n    params: ({ params: { property, depsCount, deps, missingProperty } }) => (0, codegen_1._) `{property: ${property},\n    missingProperty: ${missingProperty},\n    depsCount: ${depsCount},\n    deps: ${deps}}`, // TODO change to reference\n};\nconst def = {\n    keyword: \"dependencies\",\n    type: \"object\",\n    schemaType: \"object\",\n    error: exports.error,\n    code(cxt) {\n        const [propDeps, schDeps] = splitDependencies(cxt);\n        validatePropertyDeps(cxt, propDeps);\n        validateSchemaDeps(cxt, schDeps);\n    },\n};\nfunction splitDependencies({ schema }) {\n    const propertyDeps = {};\n    const schemaDeps = {};\n    for (const key in schema) {\n        if (key === \"__proto__\")\n            continue;\n        const deps = Array.isArray(schema[key]) ? propertyDeps : schemaDeps;\n        deps[key] = schema[key];\n    }\n    return [propertyDeps, schemaDeps];\n}\nfunction validatePropertyDeps(cxt, propertyDeps = cxt.schema) {\n    const { gen, data, it } = cxt;\n    if (Object.keys(propertyDeps).length === 0)\n        return;\n    const missing = gen.let(\"missing\");\n    for (const prop in propertyDeps) {\n        const deps = propertyDeps[prop];\n        if (deps.length === 0)\n            continue;\n        const hasProperty = (0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties);\n        cxt.setParams({\n            property: prop,\n            depsCount: deps.length,\n            deps: deps.join(\", \"),\n        });\n        if (it.allErrors) {\n            gen.if(hasProperty, () => {\n                for (const depProp of deps) {\n                    (0, code_1.checkReportMissingProp)(cxt, depProp);\n                }\n            });\n        }\n        else {\n            gen.if((0, codegen_1._) `${hasProperty} && (${(0, code_1.checkMissingProp)(cxt, deps, missing)})`);\n            (0, code_1.reportMissingProp)(cxt, missing);\n            gen.else();\n        }\n    }\n}\nexports.validatePropertyDeps = validatePropertyDeps;\nfunction validateSchemaDeps(cxt, schemaDeps = cxt.schema) {\n    const { gen, data, keyword, it } = cxt;\n    const valid = gen.name(\"valid\");\n    for (const prop in schemaDeps) {\n        if ((0, util_1.alwaysValidSchema)(it, schemaDeps[prop]))\n            continue;\n        gen.if((0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties), () => {\n            const schCxt = cxt.subschema({ keyword, schemaProp: prop }, valid);\n            cxt.mergeValidEvaluated(schCxt, valid);\n        }, () => gen.var(valid, true) // TODO var\n        );\n        cxt.ok(valid);\n    }\n}\nexports.validateSchemaDeps = validateSchemaDeps;\nexports.default = def;\n//# sourceMappingURL=dependencies.js.map","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport styled from 'styled-components'\n\nexport const FooterEl = styled.footer`\n\twidth: 100%;\n`\n\nexport const Container = styled.div`\n\twidth: 500px;\n\theight: 20px;\n\tfont-size: 12px;\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n\talign-content: center;\n\tjustify-content: space-between;\n\tmargin: auto;\n`\n\nexport const constants = {\n\tprivacyUrl: 'https://go.microsoft.com/fwlink/?LinkId=521839',\n\ttermsOfUseUrl: 'https://go.microsoft.com/fwlink/?LinkID=206977',\n\ttrademarksUrl: 'https://www.microsoft.com/trademarks',\n\tmicrosoft: 'https://www.microsoft.com',\n\tcopyright: `©️ ${new Date().getFullYear()} Microsoft`,\n}\n\nexport const LinkDiv = styled.div`\n\tcursor: pointer;\n`\nexport const LinkA = styled.a`\n\tcursor: pointer;\n\ttext-decoration: none !important;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { useMicrosoftConsentBanner } from '@essex/hooks'\nimport type { FC } from 'react'\nimport { memo } from 'react'\n\nimport { useTheme } from '../states/settings.js'\nimport {\n\tconstants,\n\tContainer,\n\tFooterEl,\n\tLinkA,\n\tLinkDiv,\n} from './Footer.styles.js'\n\nexport const Footer: FC = memo(function Footer() {\n\tconst theme = useTheme()\n\tconst CONSENT_CONF = {\n\t\ttheme: theme.variant,\n\t\telementId: 'cookie-banner',\n\t\tonChange: (c: any) => console.log('consent changed', c),\n\t}\n\tconst [, manageConsent] = useMicrosoftConsentBanner(CONSENT_CONF)\n\n\treturn (\n\t\t<FooterEl>\n\t\t\t<Container>\n\t\t\t\t<Link href={constants.privacyUrl}>Privacy</Link>\n\t\t\t\t{' | '}\n\t\t\t\t<Link\n\t\t\t\t\tid={'managecookies'}\n\t\t\t\t\tonClick={manageConsent}\n\t\t\t\t\tstyle={{ color: '#3f75bf' }}\n\t\t\t\t>\n\t\t\t\t\tCookies\n\t\t\t\t</Link>\n\t\t\t\t{' | '}\n\t\t\t\t<Link href={constants.termsOfUseUrl}>Terms of Use</Link>\n\t\t\t\t{' | '}\n\t\t\t\t<Link href={constants.trademarksUrl}>Trademarks</Link>\n\t\t\t\t{' | '}\n\t\t\t\t<Link href={constants.microsoft}>{constants.copyright}</Link>\n\t\t\t</Container>\n\t\t</FooterEl>\n\t)\n})\n\nconst Link: FC<\n\tReact.PropsWithChildren<{\n\t\thref?: string\n\t\tid?: string\n\t\tclassName?: string\n\t\tstyle?: React.CSSProperties\n\t\tonClick?: () => void\n\t}>\n> = memo(function Link({ id, className, children, href, style, onClick }) {\n\treturn href == null ? (\n\t\t<LinkDiv style={style} className={className} id={id} onClick={onClick}>\n\t\t\t{children}\n\t\t</LinkDiv>\n\t) : (\n\t\t<LinkA\n\t\t\ttarget=\"_blank\"\n\t\t\trel=\"noreferrer\"\n\t\t\thref={href}\n\t\t\tstyle={style}\n\t\t\tclassName={className}\n\t\t\tid={id}\n\t\t>\n\t\t\t{children}\n\t\t</LinkA>\n\t)\n})\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { mergeStyles, mergeStyleSets } from '@fluentui/react'\nimport { ThemeVariant } from '@thematic/core'\nimport styled from 'styled-components'\n\n// always ensure the header is dark, regardless of mode\nexport const Container = styled.div`\n\tpadding: 4px 16px 4px 16px;\n\tbackground: ${({ theme }) =>\n\t\ttheme.variant === ThemeVariant.Light\n\t\t\t? theme.application().highContrast()\n\t\t\t: theme.application().lowContrast()};\n\tborder-bottom: 1px solid\n\t\t${({ theme }) =>\n\t\t\ttheme.variant === ThemeVariant.Light\n\t\t\t\t? theme.application().midHighContrast()\n\t\t\t\t: theme.application().lowMidContrast()};\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n\talign-items: center;\n\talign-content: center;\n`\n\nexport const Title = styled.h1`\n\ttext-transform: uppercase;\n\tfont-size: 25px;\n\talign-self: center;\n\tmargin: 0;\n\tpadding: 0;\n\tcolor: ${({ theme }) =>\n\t\ttheme.variant === ThemeVariant.Light\n\t\t\t? theme.application().lowContrast()\n\t\t\t: theme.application().midHighContrast()};\n\twidth: 70%;\n`\n\nexport const iconClass = mergeStyles({\n\tfontSize: 25,\n\theight: 25,\n\twidth: 25,\n\t// goofy manual centering adjustment; icon appears to not center with flexbox mechanisms\n\tmarginTop: 3,\n\tcursor: 'pointer',\n})\n\nexport const classNames = mergeStyleSets({\n\twhite: [{ color: 'white', marginRight: 5 }, iconClass],\n})\n\nexport const Spacer = styled.div`\n\tflex: 1;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { FontIcon } from '@fluentui/react'\nimport { memo } from 'react'\n\nimport { classNames, Container, Spacer, Title } from './Header.styles.js'\nimport type { HeaderProps } from './Header.types.js'\n\nexport const Header: React.FC<HeaderProps> = memo(function Header({\n\tonMenuClick,\n\tonSettingsClick,\n}) {\n\treturn (\n\t\t<Container>\n\t\t\t<FontIcon\n\t\t\t\taria-label=\"Menu\"\n\t\t\t\ticonName=\"CollapseMenu\"\n\t\t\t\tclassName={classNames.white}\n\t\t\t\tonClick={onMenuClick}\n\t\t\t/>\n\t\t\t<Title>DataShaper</Title>\n\t\t\t<Spacer />\n\t\t\t<FontIcon\n\t\t\t\taria-label=\"Settings\"\n\t\t\t\ticonName=\"Settings\"\n\t\t\t\tclassName={classNames.white}\n\t\t\t\tonClick={onSettingsClick}\n\t\t\t/>\n\t\t</Container>\n\t)\n})\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { Spinner } from '@fluentui/react'\nimport styled from 'styled-components'\n\nexport const Content = styled.div``\nexport const Container = styled.div``\n\nexport const StyledSpinner = styled(Spinner)`\n\tmargin-top: 20px;\n`\nexport const SlidingContainer = styled.div<{ isOffset: boolean }>`\n\ttransition-timing-function: ease;\n\ttransition: 0.25s;\n\tposition: absolute;\n\twidth: ${({ isOffset }) => (isOffset ? 'calc(100% - 200px)' : '100%')};\n\tborder-left: ${({ isOffset, theme }) =>\n\t\tisOffset ? `1px solid ${theme.application().border()}` : '0'};\n\tleft: ${({ isOffset }) => (isOffset ? '200px' : '0')};\n`\n\nexport const FixedContainer = styled.div<{ isOpen: boolean }>`\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tdisplay: flex;\n\tflex: 1;\n\theight: 100%;\n\tz-index: ${({ isOpen }) => (isOpen ? '1' : '-1')};\n\ttransition-timing-function: ease;\n\ttransition: 0.25s;\n\topacity: ${({ isOpen }) => (isOpen ? '1' : '0')};\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { Link } from 'react-router-dom'\nimport styled from 'styled-components'\n\nexport const Heading = styled.h2`\n\tmargin-bottom: 10px;\n`\n\nexport const LinkSection = styled.div`\n\tmargin-left: 10px;\n\tmargin-top: 20px;\n`\n\nexport const ListItem = styled(Link)`\n\tfont-size: 14pt;\n\tdisplay: block;\n`\nexport const Container = styled.div`\n\tmargin: 8px;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { memo } from 'react'\n\nimport { Container, Heading, LinkSection, ListItem } from './NavPanel.styles.js'\nimport type { NavPanelProps } from './NavPanel.types.js'\n\nexport const NavPanel: React.FC<NavPanelProps> = memo(function NavPanel({\n\tonDismiss,\n}: NavPanelProps) {\n\treturn (\n\t\t<Container onClick={onDismiss}>\n\t\t\t<Heading>Navigation</Heading>\n\t\t\t<LinkSection>\n\t\t\t\t<ListItem to={'/'} onClick={onDismiss}>\n\t\t\t\t\tPrepare Data\n\t\t\t\t</ListItem>\n\t\t\t\t<ListItem to={'/debug'} onClick={onDismiss}>\n\t\t\t\t\tDebug\n\t\t\t\t</ListItem>\n\t\t\t</LinkSection>\n\t\t</Container>\n\t)\n})\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { Link } from 'react-router-dom'\nimport styled from 'styled-components'\n\nexport const SettingsSection = styled.div`\n\tmargin-left: 10px;\n`\n\nexport const H3 = styled.h3`\n\tmargin-bottom: 10px;\n`\n\nexport const HelpSection = styled.div`\n\tmargin-left: 10px;\n\tmargin-top: 20px;\n`\n\nexport const ListItem = styled(Link)`\n\tdisplay: block;\n`\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\n\nimport { Guidance } from '@datashaper/react'\nimport { Panel, Toggle } from '@fluentui/react'\nimport { memo, useCallback } from 'react'\n\nimport { useGuidanceIndex } from '../hooks/index.js'\nimport { useSettings } from '../states/settings.js'\nimport { useName, useSetDarkMode } from './SettingsPanel.hooks.js'\nimport { H3, HelpSection, SettingsSection } from './SettingsPanel.styles.js'\nimport type { SettingsPanelProps } from './SettingsPanel.types.js'\n\nexport const SettingsPanel: React.FC<SettingsPanelProps> = memo(\n\tfunction SettingsPanel({ isOpen, onDismiss }: SettingsPanelProps) {\n\t\tconst name = useName()\n\t\tconst index = useGuidanceIndex()\n\t\tconst [settings, setSettings] = useSettings()\n\t\tconst setDarkMode = useSetDarkMode(settings, setSettings)\n\t\tconst handleDarkModeChange = useCallback(\n\t\t\t(_ev: unknown, checked?: boolean) => void setDarkMode(checked),\n\t\t\t[setDarkMode],\n\t\t)\n\n\t\treturn (\n\t\t\t<Panel\n\t\t\t\tisLightDismiss\n\t\t\t\tisOpen={isOpen}\n\t\t\t\tonDismiss={onDismiss}\n\t\t\t\tcloseButtonAriaLabel=\"Close\"\n\t\t\t\theaderText=\"Menu\"\n\t\t\t>\n\t\t\t\t<SettingsSection>\n\t\t\t\t\t<H3>Settings</H3>\n\t\t\t\t\t<Toggle\n\t\t\t\t\t\tlabel=\"Dark Mode\"\n\t\t\t\t\t\tonText=\"On\"\n\t\t\t\t\t\toffText=\"Off\"\n\t\t\t\t\t\tonChange={handleDarkModeChange}\n\t\t\t\t\t\tchecked={settings.isDarkMode}\n\t\t\t\t\t/>\n\t\t\t\t</SettingsSection>\n\n\t\t\t\t<HelpSection>\n\t\t\t\t\t<H3>Help</H3>\n\t\t\t\t\t<Guidance name={name} index={index} />\n\t\t\t\t</HelpSection>\n\t\t\t</Panel>\n\t\t)\n\t},\n)\n","/*!\n * Copyright (c) Microsoft. All rights reserved.\n * Licensed under the MIT license. See LICENSE file in the project.\n */\nimport { Spinner } from '@fluentui/react'\nimport { memo, Suspense } from 'react'\nimport { HashRouter } from 'react-router-dom'\nimport { RecoilRoot } from 'recoil'\n\nimport { Layout } from '../components/Layout.js'\nimport { ErrorBoundary } from './ErrorBoundary.js'\nimport { RouteOptions } from './RouteOptions.js'\nimport { StyleContext } from './StyleContext.js'\n\nexport const App: React.FC = memo(function App() {\n\treturn (\n\t\t<ErrorBoundary>\n\t\t\t<RecoilRoot>\n\t\t\t\t<HashRouter>\n\t\t\t\t\t<Suspense fallback={<Spinner />}>\n\t\t\t\t\t\t<StyleContext>\n\t\t\t\t\t\t\t<Layout>\n\t\t\t\t\t\t\t\t<RouteOptions />\n\t\t\t\t\t\t\t</Layout>\n\t\t\t\t\t\t</StyleContext>\n\t\t\t\t\t</Suspense>\n\t\t\t\t</HashRouter>\n\t\t\t</RecoilRoot>\n\t\t</ErrorBoundary>\n\t)\n})\n"],"names":[],"sourceRoot":""}